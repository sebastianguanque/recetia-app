import{_ as L,u as B,a as O,c as p,b as e,d as $,n as E,e as y,o as u,f as G,r as h,g as V,h as C,t as b,w as N,v as H,i as U,F as A,j as w,k as R,l as q,m as T,p as F,q as J,s as W,x as X,y as Q,z as Y,T as Z,A as P}from"./index-ByalbOFM.js";const ee={class:"tabs",role:"tablist"},se={class:"tabs-list"},ae={class:"tab"},te=["aria-selected"],ne={class:"tab"},oe=["aria-selected"],ie={__name:"AppTabs",setup(d){const t=B(),s=O(),c=()=>{const m=prompt("Ingresa nueva API Key de Gemini:",s.apiKey);m&&m.trim()&&(s.setApiKey(m.trim()),alert("API Key actualizada correctamente"))};return(m,r)=>(u(),p("nav",ee,[e("ul",se,[e("li",ae,[e("button",{id:"recipe-creator-tab",class:E(["tab-button",{active:$(t).currentTab==="recipe-creator"}]),role:"tab","aria-selected":$(t).currentTab==="recipe-creator","aria-controls":"recipe-creator",onClick:r[0]||(r[0]=g=>$(t).switchTab("recipe-creator"))},r[2]||(r[2]=[e("i",{class:"fas fa-magic"},null,-1),y(" Creador de Recetas ",-1)]),10,te)]),e("li",ne,[e("button",{id:"shopping-list-tab",class:E(["tab-button",{active:$(t).currentTab==="shopping-list"}]),role:"tab","aria-selected":$(t).currentTab==="shopping-list","aria-controls":"shopping-list",onClick:r[1]||(r[1]=g=>$(t).switchTab("shopping-list"))},r[3]||(r[3]=[e("i",{class:"fas fa-shopping-cart"},null,-1),y(" Lista de Compras ",-1)]),10,oe)]),e("li",{class:"tab"},[e("button",{class:"tab-button",role:"button","aria-label":"Configuración de la aplicación",onClick:c},r[4]||(r[4]=[e("i",{class:"fas fa-cog"},null,-1),y(" Configuración ",-1)]))])])]))}},re=L(ie,[["__scopeId","data-v-1e74daa8"]]),z=G("ingredients",()=>{const{getItem:d,setItem:t}=V(),s=h(d("inventory_items",[]));return{ingredients:s,addIngredient:a=>{const o=a.toLowerCase().trim();o&&!s.value.includes(o)&&(s.value.push(o),t("inventory_items",s.value))},removeIngredient:a=>{s.value.splice(a,1),t("inventory_items",s.value)},clearAllIngredients:()=>{s.value=[],t("inventory_items",s.value)},categorizeIngredients:()=>{const a={meats:["pollo","carne","pescado","cerdo","ternera","atun","salmón"],vegetables:["verduras","brócoli","zanahoria","espinaca","tomate","cebolla","pimiento","lechuga","calabacín"],carbs:["arroz","pasta","pan","patata","patatas","quinoa","batata","harina","tortillas"],dairy:["leche","queso","yogurt","manteca","crema"],eggs:["huevos","huevo"],fruits:["manzana","plátano","naranja","frutas","fresa","uvas","kiwi","arándanos"],cereals:["avena","cereales","granola"],legumes:["lentejas","garbanzos","frijoles","judías"],fats:["aceite","aguacate","nueces","almendras","aceitunas"]},o={meats:[],vegetables:[],carbs:[],dairy:[],eggs:[],fruits:[],cereals:[],legumes:[],fats:[],others:[]};return s.value.forEach(i=>{let l=!1;for(const[f,n]of Object.entries(a))if(n.includes(i.toLowerCase())){o[f].push(i),l=!0;break}l||o.others.push(i)}),o}}}),le={class:"inventory-section"},ce={class:"section-header"},de={class:"input-group"},ue={class:"inventory-list",role:"list"},pe={key:0,class:"empty-state"},ge={class:"ingredient-name"},me=["aria-label","onClick"],ve={__name:"IngredientsList",setup(d){const t=z(),s=h(""),c=h(""),m=h(null),r=h(null),g=()=>{if(!s.value.trim()){c.value="Debes ingresar un ingrediente antes de agregar.",R(()=>{m.value&&m.value.focus()});return}c.value="",t.addIngredient(s.value.trim()),s.value=""},a=h(""),o=h(null),i=h(null),l=()=>{if(t.ingredients.length===0){a.value="No hay ingredientes para eliminar.",R(()=>{o.value&&o.value.focus()});return}a.value="",confirm("¿Estás seguro de que quieres eliminar todos los ingredientes?")&&t.clearAllIngredients()};return(f,n)=>(u(),p("section",le,[e("header",ce,[n[2]||(n[2]=e("h3",null,"Mis Ingredientes:",-1)),e("button",{class:"clear-btn",title:"Limpiar todos los ingredientes","aria-label":"Limpiar todos los ingredientes",onClick:l,ref_key:"clearBtn",ref:i},n[1]||(n[1]=[e("i",{class:"fas fa-trash-alt"},null,-1),y(" Limpiar Todo ",-1)]),512),a.value?(u(),p("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"clearErrorRef",ref:o},b(a.value),513)):C("",!0)]),e("form",{class:"input-form",onSubmit:U(g,["prevent"])},[e("div",de,[n[4]||(n[4]=e("label",{for:"inventoryItem",class:"sr-only"}," Agregar ingrediente ",-1)),N(e("input",{id:"inventoryItem","onUpdate:modelValue":n[0]||(n[0]=v=>s.value=v),type:"text",placeholder:"Ej: tomates, cebolla, pollo, arroz...","aria-label":"Ingresa un ingrediente"},null,512),[[H,s.value]]),e("button",{type:"submit","aria-label":"Agregar ingrediente",ref_key:"addBtn",ref:r},n[3]||(n[3]=[e("i",{class:"fas fa-plus"},null,-1),y(" Agregar ",-1)]),512),c.value?(u(),p("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:m},b(c.value),513)):C("",!0)])],32),e("ul",ue,[$(t).ingredients.length===0?(u(),p("li",pe,n[5]||(n[5]=[e("p",null," No hay ingredientes agregados. Agrega algunos ingredientes que tienes disponibles. ",-1)]))):C("",!0),(u(!0),p(A,null,w($(t).ingredients,(v,I)=>(u(),p("li",{key:`${v}-${I}`,class:"inventory-item",role:"listitem"},[e("span",ge,b(v),1),e("button",{class:"remove-item","aria-label":`Eliminar ${v}`,title:"Eliminar ingrediente",onClick:x=>$(t).removeIngredient(I)},n[6]||(n[6]=[e("i",{class:"fas fa-times"},null,-1)]),8,me)]))),128))])]))}},fe=L(ve,[["__scopeId","data-v-f3968b48"]]),ye={class:"meal-type-section"},be={class:"meal-buttons",role:"group","aria-label":"Tipo de comida"},he=["data-meal","aria-checked","onClick"],$e={__name:"MealTypeSelector",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(d,{emit:t}){const s=t,c=[{value:"desayuno",label:"Desayuno",icon:"fas fa-sun"},{value:"almuerzo",label:"Almuerzo",icon:"fas fa-utensils"},{value:"merienda",label:"Merienda",icon:"fas fa-cookie"},{value:"cena",label:"Cena",icon:"fas fa-moon"}],m=r=>{s("update:modelValue",r)};return(r,g)=>(u(),p("section",ye,[g[0]||(g[0]=e("h3",null,"Tipo de comida:",-1)),e("div",be,[(u(),p(A,null,w(c,a=>e("button",{key:a.value,class:E(["meal-btn",{selected:d.modelValue===a.value}]),"data-meal":a.value,role:"radio","aria-checked":d.modelValue===a.value,onClick:o=>m(a.value)},[e("i",{class:E(a.icon)},null,2),y(" "+b(a.label),1)],10,he)),64))])]))}},ke=L($e,[["__scopeId","data-v-f2090326"]]),_e={class:"recipe-card"},Ce={class:"recipe-header"},Se={key:0},Ie={class:"recipe-info"},Le={class:"info-item"},Re={class:"info-item"},Ee={class:"info-item"},Te={class:"ingredients-section"},xe={class:"ingredients-list"},Ae={class:"instructions-section"},we={class:"instructions-list"},Be={key:0,class:"tips-section"},Me={class:"tips-content"},je={__name:"RecipeCard",props:{recipe:{type:Object,required:!0},mealType:{type:String,required:!0}},setup(d){const t=d,s={desayuno:"fas fa-sun",almuerzo:"fas fa-utensils",merienda:"fas fa-cookie",cena:"fas fa-moon"},c={desayuno:"Desayuno",almuerzo:"Almuerzo",merienda:"Merienda",cena:"Cena"},m=q(()=>s[t.mealType]||"fas fa-utensils"),r=q(()=>c[t.mealType]||t.mealType);return(g,a)=>(u(),p("article",_e,[e("header",Ce,[e("h3",null,[e("i",{class:E(m.value)},null,2),y(" "+b(d.recipe.nombre),1)]),e("p",null,[a[0]||(a[0]=e("strong",null,"Tipo:",-1)),y(" "+b(r.value),1)]),d.recipe.cookingMethod?(u(),p("p",Se,[a[1]||(a[1]=e("strong",null,"Método de cocción:",-1)),y(" "+b(d.recipe.cookingMethod),1)])):C("",!0)]),e("div",Ie,[e("div",Le,[a[2]||(a[2]=e("i",{class:"fas fa-clock"},null,-1)),a[3]||(a[3]=e("strong",null,"Tiempo",-1)),e("span",null,b(d.recipe.tiempo),1)]),e("div",Re,[a[4]||(a[4]=e("i",{class:"fas fa-users"},null,-1)),a[5]||(a[5]=e("strong",null,"Porciones",-1)),e("span",null,b(d.recipe.porciones),1)]),e("div",Ee,[a[6]||(a[6]=e("i",{class:"fas fa-chart-line"},null,-1)),a[7]||(a[7]=e("strong",null,"Complejidad",-1)),e("span",null,b(d.recipe.complejidad),1)])]),e("section",Te,[a[8]||(a[8]=e("h4",null,[e("i",{class:"fas fa-list"}),y(" Ingredientes:")],-1)),e("div",xe,[e("ul",null,[(u(!0),p(A,null,w(d.recipe.ingredientes,o=>(u(),p("li",{key:o},b(o),1))),128))])])]),e("section",Ae,[a[9]||(a[9]=e("h4",null,[e("i",{class:"fas fa-tasks"}),y(" Instrucciones:")],-1)),e("div",we,[e("ol",null,[(u(!0),p(A,null,w(d.recipe.instrucciones,o=>(u(),p("li",{key:o},b(o),1))),128))])])]),d.recipe.consejos?(u(),p("section",Be,[a[10]||(a[10]=e("h4",null,[e("i",{class:"fas fa-lightbulb"}),y(" Consejos:")],-1)),e("div",Me,[e("p",null,b(d.recipe.consejos),1)])])):C("",!0)]))}},K=L(je,[["__scopeId","data-v-1a3d8684"]]),M=G("recipes",()=>{const{getItem:d,setItem:t}=V(),s=h(d("saved_recipes",[])),c=h([]);return{savedRecipes:s,selectedRecipesForShopping:c,saveRecipe:(o,i="individual")=>{const l={id:Date.now(),type:i,data:o,createdAt:new Date().toISOString()};s.value.push(l),t("saved_recipes",s.value)},deleteRecipe:o=>{s.value=s.value.filter(i=>i.id!==o),c.value=c.value.filter(i=>i!==o),t("saved_recipes",s.value)},clearAllRecipes:()=>{s.value=[],c.value=[],t("saved_recipes",s.value)},toggleRecipeSelection:o=>{const i=c.value.indexOf(o);i>-1?c.value.splice(i,1):c.value.push(o)}}});function Ne(){const d=O(),t=B();M();const s=z(),c=h(""),m=h(""),r=h(null);return{selectedMealType:c,selectedCookingMethod:m,generatedRecipe:r,generateRecipe:async()=>{if(s.ingredients.length===0)throw new Error("Por favor, agrega ingredientes a tu inventario para generar una receta.");if(!c.value)throw new Error("Por favor, selecciona un tipo de comida antes de generar la receta.");t.setLoading(!0);try{const a=s.categorizeIngredients(),o=s.ingredients.join(", ");let i="";switch(c.value){case"desayuno":i="Para el desayuno, genera una receta típica y adecuada para la primera comida del día. Evita explícitamente el uso de carnes pesadas (como pollo, carne de res) o pescados como ingrediente principal, y preparaciones muy elaboradas o que requieran mucho tiempo. Prioriza opciones como cereales, huevos, frutas, o lácteos.";break;case"merienda":i="Para la merienda, debe ser una opción ligera, rápida y energizante para media tarde. Evita platos principales o que requieran cocción compleja.";break;case"almuerzo":i="Para el almuerzo, genera una comida principal y sustanciosa. Debe ser una receta completa que pueda incluir proteínas, carbohidratos y vegetales.";break;case"cena":i="Para la cena, genera una comida balanceada, nutritiva y adecuada para la última comida del día. Puede ser ligeramente más ligera que el almuerzo.";break}let l="";m.value==="Sin cocción"?l="El usuario indicó que no se requiere cocción. Genera una receta que no necesite cocción ni uso de electrodomésticos.":m.value?l=`El método de cocción seleccionado por el usuario es: ${m.value}. Adapta la receta y las instrucciones para que sean adecuadas para este método.`:l="No se seleccionó método de cocción. Recomienda el método más adecuado según los ingredientes y el tipo de comida.";const f=`
        Eres un chef experto y nutricionista con un profundo conocimiento de dietas balanceadas y costumbres culinarias de Argentina. Tu objetivo es combinar la tradición culinaria local con principios nutricionales modernos para crear recetas y consejos que sean saludables, deliciosos y culturalmente apropiados.
        Necesito que generes una única receta para la comida de ${c.value}.

        Los ingredientes que tengo disponibles en mi inventario son: ${o}.
        ${i}
        ${l}

        Para la receta, proporciona:
        - **Nombre del plato**
        - **Lista completa de ingredientes** con cantidades aproximadas (puedes agregar ingredientes básicos como sal, pimienta, aceite, especias, si son necesarios y no están explícitamente en la lista original).
        - **Instrucciones** paso a paso, claras y concisas.
        - **Tiempo** de preparación (ej. "20 minutos").
        - **Porciones** (ej. "1 persona", "2 personas", "6 personas", etc).
        - **Nivel de complejidad** (Fácil/Intermedio/Difícil).
        - **Consejos** adicionales (opcional, uno o varios si aplica).

        Asegúrate de que la receta sea coherente, balanceada, nutritiva y que use los ingredientes de mi inventario de manera inteligente, no es necesario usar todos los ingredientes.
        Si un ingrediente es esencial para el tipo de comida y no está en el inventario, puedes incluirlo pero prioriza el uso de lo que tengo.

        IMPORTANTE: Responde ÚNICAMENTE con un JSON válido, sin texto adicional antes o después. No incluyas explicaciones o texto introductorio/final. Usa esta estructura exacta:
        {
            "nombre": "Nombre del plato",
            "ingredientes": ["ingrediente 1 - cantidad", "ingrediente 2 - cantidad"],
            "instrucciones": ["paso 1", "paso 2"],
            "tiempo": "X minutos",
            "porciones": "X personas",
            "complejidad": "Fácil",
            "consejos": "Consejos adicionales (opcional)"
        }
      `;let v=(await d.callGeminiAPI(f)).trim();v.startsWith("```json")&&(v=v.replace(/```json\n?/,"").replace(/\n?```$/,"")),v.startsWith("```")&&(v=v.replace(/```\n?/,"").replace(/\n?```$/,""));const I=JSON.parse(v);return I.id=Date.now().toString(),I.mealType=c.value,I.cookingMethod=m.value,r.value=I,I}catch(a){throw console.error("Error al generar la receta:",a),a}finally{t.setLoading(!1)}}}}const qe={class:"recipe-creator"},Oe={class:"cooking-method-section"},ze=["disabled"],De={__name:"RecipeCreator",setup(d){const t=Ne(),s=z(),c=B(),m=O();q(()=>s.ingredients.length>0&&t.selectedMealType.value&&m.hasApiKey);const r=h(""),g=h(null),a=h(null),o=async()=>{if(!c.isLoading){if(!m.hasApiKey){r.value="Debes ingresar una API Key válida antes de generar una receta.",R(()=>{g.value&&g.value.focus()});return}if(s.ingredients.length===0){r.value="Agrega al menos un ingrediente antes de generar una receta.",R(()=>{g.value&&g.value.focus()});return}if(!t.selectedMealType.value){r.value="Selecciona un tipo de comida antes de generar la receta.",R(()=>{g.value&&g.value.focus()});return}r.value="";try{await t.generateRecipe()}catch(f){r.value=f.message,R(()=>{g.value&&g.value.focus()})}}},i=M(),l=()=>{const f=t.generatedRecipe.value;f&&(i.saveRecipe(f),alert("Receta guardada correctamente."))};return(f,n)=>(u(),p("div",qe,[n[6]||(n[6]=e("header",{class:"section-header"},[e("h2",null,[e("i",{class:"fas fa-magic"}),y(" Creador de Recetas Inteligente")]),e("p",null,"Administra tus ingredientes y genera recetas personalizadas con IA")],-1)),T(fe),T(ke,{modelValue:$(t).selectedMealType.value,"onUpdate:modelValue":n[0]||(n[0]=v=>$(t).selectedMealType.value=v),class:"meal-type-section"},null,8,["modelValue"]),e("div",Oe,[n[3]||(n[3]=e("label",{for:"cookingMethod",class:"cooking-label"},"Método de cocción:",-1)),N(e("select",{id:"cookingMethod","onUpdate:modelValue":n[1]||(n[1]=v=>$(t).selectedCookingMethod.value=v),"aria-label":"Selecciona el método de cocción",class:"cooking-select"},n[2]||(n[2]=[W('<option value="" data-v-8fe83e7f>Selecciona...</option><option value="Sin cocción" data-v-8fe83e7f>Sin cocción / No requiere cocción</option><option value="Freidora de Aire" data-v-8fe83e7f>Freidora de Aire</option><option value="Horno" data-v-8fe83e7f>Horno</option><option value="Microondas" data-v-8fe83e7f>Microondas</option><option value="Parrilla" data-v-8fe83e7f>Parrilla</option><option value="Olla" data-v-8fe83e7f>Olla</option><option value="Sartén" data-v-8fe83e7f>Sartén</option><option value="Vapor" data-v-8fe83e7f>Vapor</option>',9)]),512),[[J,$(t).selectedCookingMethod.value]])]),e("button",{class:"generate-btn","aria-label":"Generar receta",onClick:o,disabled:$(c).isLoading,ref_key:"generateBtn",ref:a},[n[4]||(n[4]=e("i",{class:"fas fa-magic"},null,-1)),y(" "+b($(c).isLoading?"Generando...":"Generar Receta"),1)],8,ze),r.value?(u(),p("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:g},b(r.value),513)):C("",!0),$(t).generatedRecipe.value?(u(),F(K,{key:1,recipe:$(t).generatedRecipe.value,"meal-type":$(t).selectedMealType.value,class:"recipe-result"},null,8,["recipe","meal-type"])):C("",!0),$(t).generatedRecipe.value?(u(),p("button",{key:2,class:"save-btn",onClick:l,style:{"margin-top":"16px"}},n[5]||(n[5]=[e("i",{class:"fas fa-save"},null,-1),y(" Guardar Receta ",-1)]))):C("",!0)]))}},Pe=L(De,[["__scopeId","data-v-8fe83e7f"]]),Ge={class:"recipe-selection"},Ve={class:"section-header"},Ue={class:"saved-recipes-list"},Fe={key:0,class:"no-recipes"},Ke=["data-recipe-id"],He={class:"recipe-info-compact"},Je={class:"recipe-name"},We={class:"recipe-meta"},Xe={class:"recipe-actions"},Qe=["aria-label","onClick"],Ye=["aria-label","onClick"],Ze=["aria-label","onClick"],es={__name:"SavedRecipesList",setup(d){const t=M(),s=_=>t.selectedRecipesForShopping.includes(_),c=_=>new Date(_).toLocaleDateString("es-ES"),m=_=>{const k=t.savedRecipes.find(S=>S.id===_);confirm(`¿Estás seguro de que quieres eliminar la receta "${k?.data.nombre}"?`)&&t.deleteRecipe(_)},r=h(""),g=h(null),a=()=>{if(t.savedRecipes.length===0){r.value="No hay recetas guardadas para eliminar.",R(()=>{g.value&&g.value.focus()});return}r.value="",confirm("¿Estás seguro de que quieres eliminar todas las recetas guardadas?")&&t.clearAllRecipes()},o=h(!1),i=h(null),l=h(null),f=h(null),n=_=>{i.value=_,o.value=!0},v=()=>{o.value=!1,i.value=null},I=()=>{if(!i.value)return;const _=i.value.data.ingredientes?.map(k=>k.nombre?`${k.cantidad||""} ${k.unidad||""} ${k.nombre}`.trim():k).join(`
`)||"";navigator.clipboard.writeText(_),alert("Ingredientes copiados al portapapeles.")},x=()=>{if(!i.value)return;const _=i.value.data.instrucciones?.join(`
`)||"";navigator.clipboard.writeText(_),alert("Instrucciones copiadas al portapapeles.")},j=_=>{o.value&&_.key==="Escape"&&v()};return X(()=>(window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j))),Q(o,_=>{_&&f.value&&f.value.focus()}),(_,k)=>(u(),p("section",Ge,[e("header",Ve,[k[1]||(k[1]=e("h3",null,"Recetas Guardadas:",-1)),e("button",{class:"clear-btn",title:"Eliminar todas las recetas guardadas","aria-label":"Eliminar todas las recetas guardadas",onClick:a,ref:"clearBtn"},k[0]||(k[0]=[e("i",{class:"fas fa-trash-alt"},null,-1),y(" Eliminar Todas ",-1)]),512),r.value?(u(),p("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:g},b(r.value),513)):C("",!0)]),e("ul",Ue,[$(t).savedRecipes.length===0?(u(),p("li",Fe,k[2]||(k[2]=[e("i",{class:"fas fa-book-dead no-recipes-icon"},null,-1),e("p",null,[y("No hay recetas guardadas."),e("br"),y("Genera algunas recetas primero.")],-1)]))):C("",!0),(u(!0),p(A,null,w($(t).savedRecipes,S=>(u(),p("li",{key:S.id,class:E(["recipe-item",{selected:s(S.id)}]),"data-recipe-id":S.id},[e("div",He,[e("div",Je,b(S.data.nombre),1),e("div",We,[k[3]||(k[3]=e("i",{class:"fas fa-calendar"},null,-1)),y(" "+b(c(S.createdAt))+" • "+b(S.data.tiempo)+" • "+b(S.data.porciones),1)])]),e("div",Xe,[e("button",{class:"recipe-select-btn","aria-label":s(S.id)?"Deseleccionar receta":"Seleccionar receta",onClick:D=>$(t).toggleRecipeSelection(S.id)},b(s(S.id)?"Deseleccionar":"Seleccionar"),9,Qe),e("button",{class:"recipe-delete-btn",title:"Eliminar receta","aria-label":`Eliminar receta ${S.data.nombre}`,onClick:D=>m(S.id)},k[4]||(k[4]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ye),e("button",{class:"recipe-view-btn",title:"Ver receta","aria-label":`Ver receta ${S.data.nombre}`,onClick:D=>n(S)},k[5]||(k[5]=[e("i",{class:"fas fa-eye"},null,-1),y(" Ver ",-1)]),8,Ze)])],10,Ke))),128))]),T(Z,{name:"modal-fade"},{default:Y(()=>[o.value?(u(),p("div",{key:0,class:"modal-overlay blur-bg",onClick:U(v,["self"]),tabindex:"-1"},[e("div",{class:"modal-content",ref_key:"modalContent",ref:l},[e("button",{class:"close-modal-btn",onClick:v,ref_key:"closeBtn",ref:f}," Cerrar ",512),T(K,{recipe:i.value.data,"meal-type":i.value.data.mealType},null,8,["recipe","meal-type"]),e("div",{class:"copy-actions"},[e("button",{class:"copy-btn",onClick:I},k[6]||(k[6]=[e("i",{class:"fas fa-copy"},null,-1),y(" Copiar ingredientes ",-1)])),e("button",{class:"copy-btn",onClick:x},k[7]||(k[7]=[e("i",{class:"fas fa-copy"},null,-1),y(" Copiar instrucciones ",-1)]))])],512)])):C("",!0)]),_:1})]))}},ss=L(es,[["__scopeId","data-v-7f230431"]]),as={class:"shopping-options"},ts={role:"group","aria-labelledby":"shopping-options-heading"},ns={class:"option-group"},os={class:"checkbox-label"},is=["checked"],rs={class:"option-group"},ls={class:"checkbox-label"},cs=["checked"],ds={class:"option-group"},us={class:"checkbox-label"},ps=["checked"],gs={__name:"ShoppingOptions",props:{includeBasics:{type:Boolean,default:!0},groupByCategory:{type:Boolean,default:!0},excludeInventory:{type:Boolean,default:!0}},emits:["update:includeBasics","update:groupByCategory","update:excludeInventory"],setup(d){return(t,s)=>(u(),p("section",as,[s[9]||(s[9]=e("h3",null,"Opciones de Lista:",-1)),e("div",ts,[e("div",ns,[e("label",os,[e("input",{type:"checkbox",checked:d.includeBasics,onChange:s[0]||(s[0]=c=>t.$emit("update:includeBasics",c.target.checked))},null,40,is),s[3]||(s[3]=e("span",{class:"checkmark"},null,-1)),s[4]||(s[4]=y(" Incluir ingredientes básicos (sal, aceite, especias) ",-1))])]),e("div",rs,[e("label",ls,[e("input",{type:"checkbox",checked:d.groupByCategory,onChange:s[1]||(s[1]=c=>t.$emit("update:groupByCategory",c.target.checked))},null,40,cs),s[5]||(s[5]=e("span",{class:"checkmark"},null,-1)),s[6]||(s[6]=y(" Agrupar por categorías (carnes, vegetales, etc.) ",-1))])]),e("div",ds,[e("label",us,[e("input",{type:"checkbox",checked:d.excludeInventory,onChange:s[2]||(s[2]=c=>t.$emit("update:excludeInventory",c.target.checked))},null,40,ps),s[7]||(s[7]=e("span",{class:"checkmark"},null,-1)),s[8]||(s[8]=y(" Excluir ingredientes que ya tengo ",-1))])])])]))}},ms=L(gs,[["__scopeId","data-v-8343a330"]]),vs={class:"shopping-list-result"},fs={class:"shopping-summary"},ys={class:"summary-stats"},bs={class:"stat-item"},hs={class:"stat-number"},$s={key:0,class:"stat-item"},ks={class:"stat-number"},_s={class:"stat-item"},Cs={class:"stat-number"},Ss={class:"shopping-list-card"},Is={key:0},Ls={key:0},Rs={key:1,class:"shopping-items"},Es=["data-item"],Ts=["checked","onChange"],xs={class:"shopping-item-text"},As={key:1,class:"shopping-category"},ws={class:"shopping-items"},Bs=["data-item"],Ms=["checked","onChange"],js={class:"shopping-item-text"},Ns={class:"shopping-actions"},qs={__name:"ShoppingListResult",props:{shoppingList:{type:Object,required:!0},groupByCategory:{type:Boolean,default:!0}},emits:["clear"],setup(d){const t=d,s=h(new Set),c=a=>{s.value.has(a)?s.value.delete(a):s.value.add(a)},m=()=>{r().forEach(o=>s.value.add(o))},r=()=>{const a=[];return t.groupByCategory&&t.shoppingList.categorias?Object.entries(t.shoppingList.categorias).forEach(([o,i])=>{i.items&&i.items.forEach((l,f)=>{a.push(`${o}-${f}`)})}):t.shoppingList.items&&t.shoppingList.items.forEach((o,i)=>{a.push(`item-${i}`)}),a},g=()=>{let a=`=== LISTA DE COMPRAS ===

`;a+=`Generada el: ${new Date().toLocaleDateString()}
`,a+=`Total de productos: ${t.shoppingList.resumen.totalItems}
`,a+=`Productos completados: ${s.value.size}

`,a+=`PRODUCTOS PENDIENTES:
`,t.groupByCategory&&t.shoppingList.categorias?Object.entries(t.shoppingList.categorias).forEach(([f,n])=>{n.items&&n.items.length>0&&(a+=`
${n.nombre.toUpperCase()}:
`,n.items.forEach((v,I)=>{const x=`${f}-${I}`;s.value.has(x)||(a+=`☐ ${v}
`)}))}):t.shoppingList.items&&t.shoppingList.items.forEach((f,n)=>{const v=`item-${n}`;s.value.has(v)||(a+=`☐ ${f}
`)}),s.value.size>0&&(a+=`
PRODUCTOS COMPLETADOS:
`,t.groupByCategory&&t.shoppingList.categorias?Object.entries(t.shoppingList.categorias).forEach(([f,n])=>{n.items&&n.items.length>0&&n.items.filter((I,x)=>s.value.has(`${f}-${x}`)).length>0&&(a+=`
${n.nombre.toUpperCase()}:
`,n.items.forEach((I,x)=>{const j=`${f}-${x}`;s.value.has(j)&&(a+=`☑ ${I}
`)}))}):t.shoppingList.items&&t.shoppingList.items.forEach((f,n)=>{const v=`item-${n}`;s.value.has(v)&&(a+=`☑ ${f}
`)}));const o=new Blob([a],{type:"text/plain"}),i=URL.createObjectURL(o),l=document.createElement("a");l.href=i,l.download=`lista-compras-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i),alert("Lista de compras exportada exitosamente")};return(a,o)=>(u(),p("div",vs,[e("div",fs,[o[4]||(o[4]=e("h3",null,[e("i",{class:"fas fa-chart-pie"}),y(" Resumen de tu Lista de Compras")],-1)),e("div",ys,[e("div",bs,[e("span",hs,b(d.shoppingList.resumen.totalItems),1),o[1]||(o[1]=e("div",{class:"stat-label"},"Productos totales",-1))]),d.groupByCategory?(u(),p("div",$s,[e("span",ks,b(d.shoppingList.resumen.categorias),1),o[2]||(o[2]=e("div",{class:"stat-label"},"Categorías",-1))])):C("",!0),e("div",_s,[e("span",Cs,b(d.shoppingList.resumen.recetasIncluidas),1),o[3]||(o[3]=e("div",{class:"stat-label"},"Recetas incluidas",-1))])])]),e("div",Ss,[e("h3",null,[o[5]||(o[5]=e("i",{class:"fas fa-list-alt"},null,-1)),y(" Lista de Compras"+b(d.groupByCategory?" por Categorías":""),1)]),d.groupByCategory&&d.shoppingList.categorias?(u(),p("div",Is,[(u(!0),p(A,null,w(Object.entries(d.shoppingList.categorias),([i,l])=>(u(),p("div",{key:i,class:"shopping-category"},[l.items&&l.items.length>0?(u(),p("h4",Ls,[e("i",{class:E(l.icono)},null,2),y(" "+b(l.nombre),1)])):C("",!0),l.items&&l.items.length>0?(u(),p("div",Rs,[(u(!0),p(A,null,w(l.items,(f,n)=>(u(),p("div",{key:`${i}-${n}`,class:E(["shopping-item",{checked:s.value.has(`${i}-${n}`)}]),"data-item":`${i}-${n}`},[e("input",{type:"checkbox",class:"shopping-checkbox",checked:s.value.has(`${i}-${n}`),onChange:v=>c(`${i}-${n}`)},null,40,Ts),e("span",xs,b(f),1)],10,Es))),128))])):C("",!0)]))),128))])):d.shoppingList.items?(u(),p("div",As,[e("div",ws,[(u(!0),p(A,null,w(d.shoppingList.items,(i,l)=>(u(),p("div",{key:`item-${l}`,class:E(["shopping-item",{checked:s.value.has(`item-${l}`)}]),"data-item":`item-${l}`},[e("input",{type:"checkbox",class:"shopping-checkbox",checked:s.value.has(`item-${l}`),onChange:f=>c(`item-${l}`)},null,40,Ms),e("span",js,b(i),1)],10,Bs))),128))])])):C("",!0),e("div",Ns,[e("button",{class:"action-btn primary",onClick:g},o[6]||(o[6]=[e("i",{class:"fas fa-download"},null,-1),y(" Descargar Lista ",-1)])),e("button",{class:"action-btn secondary",onClick:o[0]||(o[0]=i=>a.$emit("clear"))},o[7]||(o[7]=[e("i",{class:"fas fa-trash"},null,-1),y(" Limpiar Lista ",-1)])),e("button",{class:"action-btn success",onClick:m},o[8]||(o[8]=[e("i",{class:"fas fa-check-double"},null,-1),y(" Marcar Todo ",-1)]))])])]))}},Os=L(qs,[["__scopeId","data-v-3804f03e"]]);function zs(){const d=O(),t=B(),s=M(),c=z();return{generateShoppingList:async r=>{if(s.selectedRecipesForShopping.length===0)throw new Error("Por favor selecciona al menos una receta para generar la lista de compras");t.setLoading(!0);try{const g=s.savedRecipes.filter(n=>s.selectedRecipesForShopping.includes(n.id));let a=[];g.forEach(n=>{n.data.ingredientes&&(a=a.concat(n.data.ingredientes))});const o=`
        Eres un asistente experto en compras de supermercado. Necesito que generes una lista de compras inteligente basada en los siguientes ingredientes de recetas:

        INGREDIENTES DE LAS RECETAS:
        ${a.map((n,v)=>`${v+1}. ${n}`).join(`
`)}

        ${r.excludeInventory?`
MIS INGREDIENTES ACTUALES (excluir estos ingredientes):
${c.ingredients.map(n=>`- ${n}`).join(`
`)}`:""}

        INSTRUCCIONES:
        1. Analiza todos los ingredientes y crea una lista de compras optimizada
        2. Combina ingredientes similares (ej: si aparece "tomate - 2 unidades" y "tomate - 1 unidad", combinar como "tomate - 3 unidades")
        3. ${r.excludeInventory?"Excluye los ingredientes que ya tengo disponibles":"Incluye todos los ingredientes"}
        4. ${r.includeBasics?"Incluye ingredientes básicos comunes (sal, pimienta, aceite) si no están listados":"No agregues ingredientes básicos adicionales"}
        5. ${r.groupByCategory?"Agrupa los ingredientes por categorías de supermercado":"Lista todos los ingredientes juntos"}
        6. Optimiza las cantidades para evitar desperdicios
        7. Sugiere alternativas o marcas cuando sea apropiado

        IMPORTANTE: Responde ÚNICAMENTE con un JSON válido, sin texto adicional. Usa esta estructura:
        ${r.groupByCategory?`{
          "resumen": {
              "totalItems": 0,
              "categorias": 0,
              "recetasIncluidas": ${g.length}
          },
          "categorias": {
              "carnes_pescados": {
                  "nombre": "Carnes y Pescados",
                  "icono": "fas fa-drumstick-bite",
                  "items": ["item - cantidad"]
              },
              "vegetales_frutas": {
                  "nombre": "Vegetales y Frutas",
                  "icono": "fas fa-apple-alt",
                  "items": ["item - cantidad"]
              },
              "lacteos_huevos": {
                  "nombre": "Lácteos y Huevos",
                  "icono": "fas fa-cheese",
                  "items": ["item - cantidad"]
              },
              "cereales_granos": {
                  "nombre": "Cereales y Granos",
                  "icono": "fas fa-seedling",
                  "items": ["item - cantidad"]
              },
              "condimentos_especias": {
                  "nombre": "Condimentos y Especias",
                  "icono": "fas fa-pepper-hot",
                  "items": ["item - cantidad"]
              },
              "otros": {
                  "nombre": "Otros",
                  "icono": "fas fa-shopping-basket",
                  "items": ["item - cantidad"]
              }
          }
      }`:`{
          "resumen": {
              "totalItems": 0,
              "recetasIncluidas": ${g.length}
          },
          "items": ["item - cantidad", "item - cantidad"]
      }`}
      `;let l=(await d.callGeminiAPI(o)).trim();return l.startsWith("```json")&&(l=l.replace(/```json\n?/,"").replace(/\n?```$/,"")),l.startsWith("```")&&(l=l.replace(/```\n?/,"").replace(/\n?```$/,"")),JSON.parse(l)}catch(g){throw console.error("Error al generar la lista de compras:",g),g}finally{t.setLoading(!1)}}}}const Ds={class:"shopping-list"},Ps={class:"shopping-controls"},Gs=["disabled"],Vs={__name:"ShoppingList",setup(d){const t=M(),s=B(),c=zs(),m=h({includeBasics:!0,groupByCategory:!0,excludeInventory:!0}),r=h(null);q(()=>t.selectedRecipesForShopping.length>0);const g=h(""),a=h(null),o=h(null),i=async()=>{if(!s.isLoading){if(t.selectedRecipesForShopping.length===0){g.value="Selecciona al menos una receta antes de generar la lista de compras.",R(()=>{a.value&&a.value.focus()});return}g.value="";try{const f=await c.generateShoppingList(m.value);r.value=f}catch(f){g.value=f.message,R(()=>{a.value&&a.value.focus()})}}},l=()=>{confirm("¿Estás seguro de que quieres limpiar la lista de compras?")&&(r.value=null,t.selectedRecipesForShopping.length=0)};return(f,n)=>(u(),p("div",Ds,[n[4]||(n[4]=e("header",{class:"section-header"},[e("h2",null,[e("i",{class:"fas fa-shopping-cart"}),y(" Lista de Compras Inteligente")]),e("p",null," Genera automáticamente tu lista de compras basada en las recetas y tus ingredientes actuales ")],-1)),e("div",Ps,[T(ss),T(ms,{"include-basics":m.value.includeBasics,"onUpdate:includeBasics":n[0]||(n[0]=v=>m.value.includeBasics=v),"group-by-category":m.value.groupByCategory,"onUpdate:groupByCategory":n[1]||(n[1]=v=>m.value.groupByCategory=v),"exclude-inventory":m.value.excludeInventory,"onUpdate:excludeInventory":n[2]||(n[2]=v=>m.value.excludeInventory=v)},null,8,["include-basics","group-by-category","exclude-inventory"]),e("button",{class:"generate-btn","aria-label":"Generar lista de compras",onClick:i,disabled:$(s).isLoading,ref_key:"generateBtn",ref:o},[n[3]||(n[3]=e("i",{class:"fas fa-list-alt"},null,-1)),y(" "+b($(s).isLoading?"Generando...":"Generar Lista de Compras"),1)],8,Gs),g.value?(u(),p("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:a},b(g.value),513)):C("",!0)]),r.value?(u(),F(Os,{key:0,"shopping-list":r.value,"group-by-category":m.value.groupByCategory,onClear:l},null,8,["shopping-list","group-by-category"])):C("",!0)]))}},Us=L(Vs,[["__scopeId","data-v-4bfc12b0"]]),Fs={class:"main-app"},Ks={class:"tab-content",role:"tabpanel","aria-labelledby":"recipe-creator-tab"},Hs={class:"tab-content",role:"tabpanel","aria-labelledby":"shopping-list-tab"},Js={__name:"HomeView",setup(d){const t=B();return(s,c)=>(u(),p("main",Fs,[T(re),N(e("section",Ks,[T(Pe)],512),[[P,$(t).currentTab==="recipe-creator"]]),N(e("section",Hs,[T(Us)],512),[[P,$(t).currentTab==="shopping-list"]])]))}},Xs=L(Js,[["__scopeId","data-v-7898df1b"]]);export{Xs as default};
//# sourceMappingURL=HomeView-CHJRKwZd.js.map
