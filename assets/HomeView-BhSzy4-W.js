import{_ as S,u as w,a as B,c as g,b as e,d as h,n as L,e as b,o as u,f as q,r as C,g as P,w as z,v as U,h as G,i as I,F as E,j as T,t as y,k as j,l as R,m as M,p as F,q as K,s as J,T as W,x as N}from"./index-CPV7zKiQ.js";const H={class:"tabs",role:"tablist"},X={class:"tabs-list"},Q={class:"tab"},Y=["aria-selected"],Z={class:"tab"},ee=["aria-selected"],se={__name:"AppTabs",setup(r){const a=w(),s=B(),c=()=>{const v=prompt("Ingresa nueva API Key de Gemini:",s.apiKey);v&&v.trim()&&(s.setApiKey(v.trim()),alert("API Key actualizada correctamente"))};return(v,p)=>(u(),g("nav",H,[e("ul",X,[e("li",Q,[e("button",{id:"recipe-creator-tab",class:L(["tab-button",{active:h(a).currentTab==="recipe-creator"}]),role:"tab","aria-selected":h(a).currentTab==="recipe-creator","aria-controls":"recipe-creator",onClick:p[0]||(p[0]=l=>h(a).switchTab("recipe-creator"))},p[2]||(p[2]=[e("i",{class:"fas fa-magic"},null,-1),b(" Creador de Recetas ",-1)]),10,Y)]),e("li",Z,[e("button",{id:"shopping-list-tab",class:L(["tab-button",{active:h(a).currentTab==="shopping-list"}]),role:"tab","aria-selected":h(a).currentTab==="shopping-list","aria-controls":"shopping-list",onClick:p[1]||(p[1]=l=>h(a).switchTab("shopping-list"))},p[3]||(p[3]=[e("i",{class:"fas fa-shopping-cart"},null,-1),b(" Lista de Compras ",-1)]),10,ee)]),e("li",{class:"tab"},[e("button",{class:"tab-button",role:"button","aria-label":"Configuración de la aplicación",onClick:c},p[4]||(p[4]=[e("i",{class:"fas fa-cog"},null,-1),b(" Configuración ",-1)]))])])]))}},te=S(se,[["__scopeId","data-v-1e74daa8"]]),O=q("ingredients",()=>{const{getItem:r,setItem:a}=P(),s=C(r("inventory_items",[]));return{ingredients:s,addIngredient:t=>{const n=t.toLowerCase().trim();n&&!s.value.includes(n)&&(s.value.push(n),a("inventory_items",s.value))},removeIngredient:t=>{s.value.splice(t,1),a("inventory_items",s.value)},clearAllIngredients:()=>{s.value=[],a("inventory_items",s.value)},categorizeIngredients:()=>{const t={meats:["pollo","carne","pescado","cerdo","ternera","atun","salmón"],vegetables:["verduras","brócoli","zanahoria","espinaca","tomate","cebolla","pimiento","lechuga","calabacín"],carbs:["arroz","pasta","pan","patata","patatas","quinoa","batata","harina","tortillas"],dairy:["leche","queso","yogurt","manteca","crema"],eggs:["huevos","huevo"],fruits:["manzana","plátano","naranja","frutas","fresa","uvas","kiwi","arándanos"],cereals:["avena","cereales","granola"],legumes:["lentejas","garbanzos","frijoles","judías"],fats:["aceite","aguacate","nueces","almendras","aceitunas"]},n={meats:[],vegetables:[],carbs:[],dairy:[],eggs:[],fruits:[],cereals:[],legumes:[],fats:[],others:[]};return s.value.forEach(o=>{let i=!1;for(const[m,d]of Object.entries(t))if(d.includes(o.toLowerCase())){n[m].push(o),i=!0;break}i||n.others.push(o)}),n}}}),ae={class:"inventory-section"},ne={class:"section-header"},ie=["disabled"],oe={class:"input-group"},le=["disabled"],re={class:"inventory-list",role:"list"},ce={key:0,class:"empty-state"},de={class:"ingredient-name"},ue=["aria-label","onClick"],pe={__name:"IngredientsList",setup(r){const a=O(),s=C(""),c=()=>{s.value.trim()&&(a.addIngredient(s.value.trim()),s.value="")},v=()=>{confirm("¿Estás seguro de que quieres eliminar todos los ingredientes?")&&a.clearAllIngredients()};return(p,l)=>(u(),g("section",ae,[e("header",ne,[l[2]||(l[2]=e("h3",null,"Mis Ingredientes:",-1)),e("button",{class:"clear-btn",disabled:h(a).ingredients.length===0,title:"Limpiar todos los ingredientes","aria-label":"Limpiar todos los ingredientes",onClick:v},l[1]||(l[1]=[e("i",{class:"fas fa-trash-alt"},null,-1),b(" Limpiar Todo ",-1)]),8,ie)]),e("form",{class:"input-form",onSubmit:G(c,["prevent"])},[e("div",oe,[l[4]||(l[4]=e("label",{for:"inventoryItem",class:"sr-only"}," Agregar ingrediente ",-1)),z(e("input",{id:"inventoryItem","onUpdate:modelValue":l[0]||(l[0]=t=>s.value=t),type:"text",placeholder:"Ej: tomates, cebolla, pollo, arroz...","aria-label":"Ingresa un ingrediente"},null,512),[[U,s.value]]),e("button",{type:"submit",disabled:!s.value.trim(),"aria-label":"Agregar ingrediente"},l[3]||(l[3]=[e("i",{class:"fas fa-plus"},null,-1),b(" Agregar ",-1)]),8,le)])],32),e("ul",re,[h(a).ingredients.length===0?(u(),g("li",ce,l[5]||(l[5]=[e("p",null," No hay ingredientes agregados. Agrega algunos ingredientes que tienes disponibles. ",-1)]))):I("",!0),(u(!0),g(E,null,T(h(a).ingredients,(t,n)=>(u(),g("li",{key:`${t}-${n}`,class:"inventory-item",role:"listitem"},[e("span",de,y(t),1),e("button",{class:"remove-item","aria-label":`Eliminar ${t}`,title:"Eliminar ingrediente",onClick:o=>h(a).removeIngredient(n)},l[6]||(l[6]=[e("i",{class:"fas fa-times"},null,-1)]),8,ue)]))),128))])]))}},me=S(pe,[["__scopeId","data-v-e63b56b4"]]),ge={class:"meal-type-section"},ve={class:"meal-buttons",role:"group","aria-label":"Tipo de comida"},be=["data-meal","aria-checked","onClick"],fe={__name:"MealTypeSelector",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(r,{emit:a}){const s=a,c=[{value:"desayuno",label:"Desayuno",icon:"fas fa-sun"},{value:"almuerzo",label:"Almuerzo",icon:"fas fa-utensils"},{value:"merienda",label:"Merienda",icon:"fas fa-cookie"},{value:"cena",label:"Cena",icon:"fas fa-moon"}],v=p=>{s("update:modelValue",p)};return(p,l)=>(u(),g("section",ge,[l[0]||(l[0]=e("h3",null,"Tipo de comida:",-1)),e("div",ve,[(u(),g(E,null,T(c,t=>e("button",{key:t.value,class:L(["meal-btn",{selected:r.modelValue===t.value}]),"data-meal":t.value,role:"radio","aria-checked":r.modelValue===t.value,onClick:n=>v(t.value)},[e("i",{class:L(t.icon)},null,2),b(" "+y(t.label),1)],10,be)),64))])]))}},he=S(fe,[["__scopeId","data-v-f2090326"]]),ye={class:"recipe-card"},$e={class:"recipe-header"},_e={class:"recipe-info"},Ce={class:"info-item"},ke={class:"info-item"},Ie={class:"info-item"},Se={class:"ingredients-section"},Le={class:"ingredients-list"},Re={class:"instructions-section"},Ee={class:"instructions-list"},Te={key:0,class:"tips-section"},xe={class:"tips-content"},we={__name:"RecipeCard",props:{recipe:{type:Object,required:!0},mealType:{type:String,required:!0}},setup(r){const a=r,s={desayuno:"fas fa-sun",almuerzo:"fas fa-utensils",merienda:"fas fa-cookie",cena:"fas fa-moon"},c={desayuno:"Desayuno",almuerzo:"Almuerzo",merienda:"Merienda",cena:"Cena"},v=j(()=>s[a.mealType]||"fas fa-utensils"),p=j(()=>c[a.mealType]||a.mealType);return(l,t)=>(u(),g("article",ye,[e("header",$e,[e("h3",null,[e("i",{class:L(v.value)},null,2),b(" "+y(r.recipe.nombre),1)]),e("p",null,[t[0]||(t[0]=e("strong",null,"Tipo:",-1)),b(" "+y(p.value),1)])]),e("div",_e,[e("div",Ce,[t[1]||(t[1]=e("i",{class:"fas fa-clock"},null,-1)),t[2]||(t[2]=e("strong",null,"Tiempo",-1)),e("span",null,y(r.recipe.tiempo),1)]),e("div",ke,[t[3]||(t[3]=e("i",{class:"fas fa-users"},null,-1)),t[4]||(t[4]=e("strong",null,"Porciones",-1)),e("span",null,y(r.recipe.porciones),1)]),e("div",Ie,[t[5]||(t[5]=e("i",{class:"fas fa-chart-line"},null,-1)),t[6]||(t[6]=e("strong",null,"Complejidad",-1)),e("span",null,y(r.recipe.complejidad),1)])]),e("section",Se,[t[7]||(t[7]=e("h4",null,[e("i",{class:"fas fa-list"}),b(" Ingredientes:")],-1)),e("div",Le,[e("ul",null,[(u(!0),g(E,null,T(r.recipe.ingredientes,n=>(u(),g("li",{key:n},y(n),1))),128))])])]),e("section",Re,[t[8]||(t[8]=e("h4",null,[e("i",{class:"fas fa-tasks"}),b(" Instrucciones:")],-1)),e("div",Ee,[e("ol",null,[(u(!0),g(E,null,T(r.recipe.instrucciones,n=>(u(),g("li",{key:n},y(n),1))),128))])])]),r.recipe.consejos?(u(),g("section",Te,[t[9]||(t[9]=e("h4",null,[e("i",{class:"fas fa-lightbulb"}),b(" Consejos:")],-1)),e("div",xe,[e("p",null,y(r.recipe.consejos),1)])])):I("",!0)]))}},V=S(we,[["__scopeId","data-v-92852eaf"]]),A=q("recipes",()=>{const{getItem:r,setItem:a}=P(),s=C(r("saved_recipes",[])),c=C([]);return{savedRecipes:s,selectedRecipesForShopping:c,saveRecipe:(n,o="individual")=>{const i={id:Date.now(),type:o,data:n,createdAt:new Date().toISOString()};s.value.push(i),a("saved_recipes",s.value)},deleteRecipe:n=>{s.value=s.value.filter(o=>o.id!==n),c.value=c.value.filter(o=>o!==n),a("saved_recipes",s.value)},clearAllRecipes:()=>{s.value=[],c.value=[],a("saved_recipes",s.value)},toggleRecipeSelection:n=>{const o=c.value.indexOf(n);o>-1?c.value.splice(o,1):c.value.push(n)}}});function Ae(){const r=B(),a=w();A();const s=O(),c=C(""),v=C(null);return{selectedMealType:c,generatedRecipe:v,generateRecipe:async()=>{if(s.ingredients.length===0)throw new Error("Por favor, agrega ingredientes a tu inventario para generar una receta.");if(!c.value)throw new Error("Por favor, selecciona un tipo de comida antes de generar la receta.");a.setLoading(!0);try{const l=s.categorizeIngredients(),t=s.ingredients.join(", ");let n="";switch(c.value){case"desayuno":n="Para el desayuno, genera una receta típica y adecuada para la primera comida del día. Evita explícitamente el uso de carnes pesadas (como pollo, carne de res) o pescados como ingrediente principal, y preparaciones muy elaboradas o que requieran mucho tiempo. Prioriza opciones como cereales, huevos, frutas, o lácteos.";break;case"merienda":n="Para la merienda, debe ser una opción ligera, rápida y energizante para media tarde. Evita platos principales o que requieran cocción compleja.";break;case"almuerzo":n="Para el almuerzo, genera una comida principal y sustanciosa. Debe ser una receta completa que pueda incluir proteínas, carbohidratos y vegetales.";break;case"cena":n="Para la cena, genera una comida balanceada, nutritiva y adecuada para la última comida del día. Puede ser ligeramente más ligera que el almuerzo.";break}const o=`
        Eres un chef experto y nutricionista con un profundo conocimiento de dietas balanceadas y costumbres culinarias de Argentina. Tu objetivo es combinar la tradición culinaria local con principios nutricionales modernos para crear recetas y consejos que sean saludables, deliciosos y culturalmente apropiados.
        Necesito que generes una única receta para la comida de ${c.value}.

        Los ingredientes que tengo disponibles en mi inventario son: ${t}.
        ${n}

        Para la receta, proporciona:
        - **Nombre del plato**
        - **Lista completa de ingredientes** con cantidades aproximadas (puedes agregar ingredientes básicos como sal, pimienta, aceite, especias, si son necesarios y no están explícitamente en la lista original).
        - **Instrucciones** paso a paso, claras y concisas.
        - **Tiempo** de preparación (ej. "20 minutos").
        - **Porciones** (ej. "1 persona", "2 personas", "6 personas", etc).
        - **Nivel de complejidad** (Fácil/Intermedio/Difícil).
        - **Consejos** adicionales (opcional, uno o varios si aplica).

        Asegúrate de que la receta sea coherente, balanceada, nutritiva y que use los ingredientes de mi inventario de manera inteligente, no es necesario usar todos los ingredientes.
        Si un ingrediente es esencial para el tipo de comida y no está en el inventario, puedes incluirlo pero prioriza el uso de lo que tengo.

        IMPORTANTE: Responde ÚNICAMENTE con un JSON válido, sin texto adicional antes o después. No incluyas explicaciones o texto introductorio/final. Usa esta estructura exacta:
        {
            "nombre": "Nombre del plato",
            "ingredientes": ["ingrediente 1 - cantidad", "ingrediente 2 - cantidad"],
            "instrucciones": ["paso 1", "paso 2"],
            "tiempo": "X minutos",
            "porciones": "X personas",
            "complejidad": "Fácil",
            "consejos": "Consejos adicionales (opcional)"
        }
      `;let m=(await r.callGeminiAPI(o)).trim();m.startsWith("```json")&&(m=m.replace(/```json\n?/,"").replace(/\n?```$/,"")),m.startsWith("```")&&(m=m.replace(/```\n?/,"").replace(/\n?```$/,""));const d=JSON.parse(m);return d.id=Date.now().toString(),d.mealType=c.value,v.value=d,d;return d}catch(l){throw console.error("Error al generar la receta:",l),l}finally{a.setLoading(!1)}}}}const je={class:"recipe-creator"},Be=["disabled"],Oe={__name:"RecipeCreator",setup(r){const a=Ae(),s=O(),c=w(),v=B(),p=j(()=>s.ingredients.length>0&&a.selectedMealType.value&&v.hasApiKey),l=async()=>{if(!v.hasApiKey){alert("Debes ingresar una API Key válida antes de generar una receta.");return}try{await a.generateRecipe()}catch(o){alert(o.message)}},t=A(),n=()=>{const o=a.generatedRecipe.value;o&&(t.saveRecipe(o),alert("Receta guardada correctamente."))};return(o,i)=>(u(),g("div",je,[i[3]||(i[3]=e("header",{class:"section-header"},[e("h2",null,[e("i",{class:"fas fa-magic"}),b(" Creador de Recetas Inteligente")]),e("p",null,"Administra tus ingredientes y genera recetas personalizadas con IA")],-1)),R(me),R(he,{modelValue:h(a).selectedMealType.value,"onUpdate:modelValue":i[0]||(i[0]=m=>h(a).selectedMealType.value=m),class:"meal-type-section"},null,8,["modelValue"]),e("button",{class:"generate-btn",disabled:!p.value||h(c).isLoading,"aria-label":"Generar receta",onClick:l},[i[1]||(i[1]=e("i",{class:"fas fa-magic"},null,-1)),b(" "+y(h(c).isLoading?"Generando...":"Generar Receta"),1)],8,Be),h(a).generatedRecipe.value?(u(),M(V,{key:0,recipe:h(a).generatedRecipe.value,"meal-type":h(a).selectedMealType.value,class:"recipe-result"},null,8,["recipe","meal-type"])):I("",!0),h(a).generatedRecipe.value?(u(),g("button",{key:1,class:"save-btn",onClick:n,style:{"margin-top":"16px"}},i[2]||(i[2]=[e("i",{class:"fas fa-save"},null,-1),b(" Guardar Receta ",-1)]))):I("",!0)]))}},ze=S(Oe,[["__scopeId","data-v-fbeb0298"]]),De={class:"recipe-selection"},Ne={class:"section-header"},qe=["disabled"],Pe={class:"saved-recipes-list"},Ge={key:0,class:"no-recipes"},Me=["data-recipe-id"],Ve={class:"recipe-info-compact"},Ue={class:"recipe-name"},Fe={class:"recipe-meta"},Ke={class:"recipe-actions"},Je=["aria-label","onClick"],We=["aria-label","onClick"],He=["aria-label","onClick"],Xe={__name:"SavedRecipesList",setup(r){const a=A(),s=$=>a.selectedRecipesForShopping.includes($),c=$=>new Date($).toLocaleDateString("es-ES"),v=$=>{const f=a.savedRecipes.find(_=>_.id===$);confirm(`¿Estás seguro de que quieres eliminar la receta "${f?.data.nombre}"?`)&&a.deleteRecipe($)},p=()=>{confirm("¿Estás seguro de que quieres eliminar todas las recetas guardadas?")&&a.clearAllRecipes()},l=C(!1),t=C(null),n=C(null),o=C(null),i=$=>{t.value=$,l.value=!0},m=()=>{l.value=!1,t.value=null},d=()=>{if(!t.value)return;const $=t.value.data.ingredientes?.map(f=>f.nombre?`${f.cantidad||""} ${f.unidad||""} ${f.nombre}`.trim():f).join(`
`)||"";navigator.clipboard.writeText($),alert("Ingredientes copiados al portapapeles.")},k=()=>{if(!t.value)return;const $=t.value.data.instrucciones?.join(`
`)||"";navigator.clipboard.writeText($),alert("Instrucciones copiadas al portapapeles.")},x=$=>{l.value&&$.key==="Escape"&&m()};return F(()=>(window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x))),K(l,$=>{$&&o.value&&o.value.focus()}),($,f)=>(u(),g("section",De,[e("header",Ne,[f[1]||(f[1]=e("h3",null,"Recetas Guardadas:",-1)),e("button",{class:"clear-btn",disabled:h(a).savedRecipes.length===0,title:"Eliminar todas las recetas guardadas","aria-label":"Eliminar todas las recetas guardadas",onClick:p},f[0]||(f[0]=[e("i",{class:"fas fa-trash-alt"},null,-1),b(" Eliminar Todas ",-1)]),8,qe)]),e("ul",Pe,[h(a).savedRecipes.length===0?(u(),g("li",Ge,f[2]||(f[2]=[e("i",{class:"fas fa-book-dead no-recipes-icon"},null,-1),e("p",null,[b("No hay recetas guardadas."),e("br"),b("Genera algunas recetas primero.")],-1)]))):I("",!0),(u(!0),g(E,null,T(h(a).savedRecipes,_=>(u(),g("li",{key:_.id,class:L(["recipe-item",{selected:s(_.id)}]),"data-recipe-id":_.id},[e("div",Ve,[e("div",Ue,y(_.data.nombre),1),e("div",Fe,[f[3]||(f[3]=e("i",{class:"fas fa-calendar"},null,-1)),b(" "+y(c(_.createdAt))+" • "+y(_.data.tiempo)+" • "+y(_.data.porciones),1)])]),e("div",Ke,[e("button",{class:"recipe-select-btn","aria-label":s(_.id)?"Deseleccionar receta":"Seleccionar receta",onClick:D=>h(a).toggleRecipeSelection(_.id)},y(s(_.id)?"Deseleccionar":"Seleccionar"),9,Je),e("button",{class:"recipe-delete-btn",title:"Eliminar receta","aria-label":`Eliminar receta ${_.data.nombre}`,onClick:D=>v(_.id)},f[4]||(f[4]=[e("i",{class:"fas fa-trash"},null,-1)]),8,We),e("button",{class:"recipe-view-btn",title:"Ver receta","aria-label":`Ver receta ${_.data.nombre}`,onClick:D=>i(_)},f[5]||(f[5]=[e("i",{class:"fas fa-eye"},null,-1),b(" Ver ",-1)]),8,He)])],10,Me))),128))]),R(W,{name:"modal-fade"},{default:J(()=>[l.value?(u(),g("div",{key:0,class:"modal-overlay blur-bg",onClick:G(m,["self"]),tabindex:"-1"},[e("div",{class:"modal-content",ref_key:"modalContent",ref:n},[e("button",{class:"close-modal-btn",onClick:m,ref_key:"closeBtn",ref:o},"Cerrar",512),R(V,{recipe:t.value.data},null,8,["recipe"]),e("div",{class:"copy-actions"},[e("button",{class:"copy-btn",onClick:d},f[6]||(f[6]=[e("i",{class:"fas fa-copy"},null,-1),b(" Copiar ingredientes ",-1)])),e("button",{class:"copy-btn",onClick:k},f[7]||(f[7]=[e("i",{class:"fas fa-copy"},null,-1),b(" Copiar instrucciones ",-1)]))])],512)])):I("",!0)]),_:1})]))}},Qe=S(Xe,[["__scopeId","data-v-27c10edf"]]),Ye={class:"shopping-options"},Ze={role:"group","aria-labelledby":"shopping-options-heading"},es={class:"option-group"},ss={class:"checkbox-label"},ts=["checked"],as={class:"option-group"},ns={class:"checkbox-label"},is=["checked"],os={class:"option-group"},ls={class:"checkbox-label"},rs=["checked"],cs={__name:"ShoppingOptions",props:{includeBasics:{type:Boolean,default:!0},groupByCategory:{type:Boolean,default:!0},excludeInventory:{type:Boolean,default:!0}},emits:["update:includeBasics","update:groupByCategory","update:excludeInventory"],setup(r){return(a,s)=>(u(),g("section",Ye,[s[9]||(s[9]=e("h3",null,"Opciones de Lista:",-1)),e("div",Ze,[e("div",es,[e("label",ss,[e("input",{type:"checkbox",checked:r.includeBasics,onChange:s[0]||(s[0]=c=>a.$emit("update:includeBasics",c.target.checked))},null,40,ts),s[3]||(s[3]=e("span",{class:"checkmark"},null,-1)),s[4]||(s[4]=b(" Incluir ingredientes básicos (sal, aceite, especias) ",-1))])]),e("div",as,[e("label",ns,[e("input",{type:"checkbox",checked:r.groupByCategory,onChange:s[1]||(s[1]=c=>a.$emit("update:groupByCategory",c.target.checked))},null,40,is),s[5]||(s[5]=e("span",{class:"checkmark"},null,-1)),s[6]||(s[6]=b(" Agrupar por categorías (carnes, vegetales, etc.) ",-1))])]),e("div",os,[e("label",ls,[e("input",{type:"checkbox",checked:r.excludeInventory,onChange:s[2]||(s[2]=c=>a.$emit("update:excludeInventory",c.target.checked))},null,40,rs),s[7]||(s[7]=e("span",{class:"checkmark"},null,-1)),s[8]||(s[8]=b(" Excluir ingredientes que ya tengo ",-1))])])])]))}},ds=S(cs,[["__scopeId","data-v-8343a330"]]),us={class:"shopping-list-result"},ps={class:"shopping-summary"},ms={class:"summary-stats"},gs={class:"stat-item"},vs={class:"stat-number"},bs={key:0,class:"stat-item"},fs={class:"stat-number"},hs={class:"stat-item"},ys={class:"stat-number"},$s={class:"shopping-list-card"},_s={key:0},Cs={key:0},ks={key:1,class:"shopping-items"},Is=["data-item"],Ss=["checked","onChange"],Ls={class:"shopping-item-text"},Rs={key:1,class:"shopping-category"},Es={class:"shopping-items"},Ts=["data-item"],xs=["checked","onChange"],ws={class:"shopping-item-text"},As={class:"shopping-actions"},js={__name:"ShoppingListResult",props:{shoppingList:{type:Object,required:!0},groupByCategory:{type:Boolean,default:!0}},emits:["clear"],setup(r){const a=r,s=C(new Set),c=t=>{s.value.has(t)?s.value.delete(t):s.value.add(t)},v=()=>{p().forEach(n=>s.value.add(n))},p=()=>{const t=[];return a.groupByCategory&&a.shoppingList.categorias?Object.entries(a.shoppingList.categorias).forEach(([n,o])=>{o.items&&o.items.forEach((i,m)=>{t.push(`${n}-${m}`)})}):a.shoppingList.items&&a.shoppingList.items.forEach((n,o)=>{t.push(`item-${o}`)}),t},l=()=>{let t=`=== LISTA DE COMPRAS ===

`;t+=`Generada el: ${new Date().toLocaleDateString()}
`,t+=`Total de productos: ${a.shoppingList.resumen.totalItems}
`,t+=`Productos completados: ${s.value.size}

`,t+=`PRODUCTOS PENDIENTES:
`,a.groupByCategory&&a.shoppingList.categorias?Object.entries(a.shoppingList.categorias).forEach(([m,d])=>{d.items&&d.items.length>0&&(t+=`
${d.nombre.toUpperCase()}:
`,d.items.forEach((k,x)=>{const $=`${m}-${x}`;s.value.has($)||(t+=`☐ ${k}
`)}))}):a.shoppingList.items&&a.shoppingList.items.forEach((m,d)=>{const k=`item-${d}`;s.value.has(k)||(t+=`☐ ${m}
`)}),s.value.size>0&&(t+=`
PRODUCTOS COMPLETADOS:
`,a.groupByCategory&&a.shoppingList.categorias?Object.entries(a.shoppingList.categorias).forEach(([m,d])=>{d.items&&d.items.length>0&&d.items.filter((x,$)=>s.value.has(`${m}-${$}`)).length>0&&(t+=`
${d.nombre.toUpperCase()}:
`,d.items.forEach((x,$)=>{const f=`${m}-${$}`;s.value.has(f)&&(t+=`☑ ${x}
`)}))}):a.shoppingList.items&&a.shoppingList.items.forEach((m,d)=>{const k=`item-${d}`;s.value.has(k)&&(t+=`☑ ${m}
`)}));const n=new Blob([t],{type:"text/plain"}),o=URL.createObjectURL(n),i=document.createElement("a");i.href=o,i.download=`lista-compras-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o),alert("Lista de compras exportada exitosamente")};return(t,n)=>(u(),g("div",us,[e("div",ps,[n[4]||(n[4]=e("h3",null,[e("i",{class:"fas fa-chart-pie"}),b(" Resumen de tu Lista de Compras")],-1)),e("div",ms,[e("div",gs,[e("span",vs,y(r.shoppingList.resumen.totalItems),1),n[1]||(n[1]=e("div",{class:"stat-label"},"Productos totales",-1))]),r.groupByCategory?(u(),g("div",bs,[e("span",fs,y(r.shoppingList.resumen.categorias),1),n[2]||(n[2]=e("div",{class:"stat-label"},"Categorías",-1))])):I("",!0),e("div",hs,[e("span",ys,y(r.shoppingList.resumen.recetasIncluidas),1),n[3]||(n[3]=e("div",{class:"stat-label"},"Recetas incluidas",-1))])])]),e("div",$s,[e("h3",null,[n[5]||(n[5]=e("i",{class:"fas fa-list-alt"},null,-1)),b(" Lista de Compras"+y(r.groupByCategory?" por Categorías":""),1)]),r.groupByCategory&&r.shoppingList.categorias?(u(),g("div",_s,[(u(!0),g(E,null,T(Object.entries(r.shoppingList.categorias),([o,i])=>(u(),g("div",{key:o,class:"shopping-category"},[i.items&&i.items.length>0?(u(),g("h4",Cs,[e("i",{class:L(i.icono)},null,2),b(" "+y(i.nombre),1)])):I("",!0),i.items&&i.items.length>0?(u(),g("div",ks,[(u(!0),g(E,null,T(i.items,(m,d)=>(u(),g("div",{key:`${o}-${d}`,class:L(["shopping-item",{checked:s.value.has(`${o}-${d}`)}]),"data-item":`${o}-${d}`},[e("input",{type:"checkbox",class:"shopping-checkbox",checked:s.value.has(`${o}-${d}`),onChange:k=>c(`${o}-${d}`)},null,40,Ss),e("span",Ls,y(m),1)],10,Is))),128))])):I("",!0)]))),128))])):r.shoppingList.items?(u(),g("div",Rs,[e("div",Es,[(u(!0),g(E,null,T(r.shoppingList.items,(o,i)=>(u(),g("div",{key:`item-${i}`,class:L(["shopping-item",{checked:s.value.has(`item-${i}`)}]),"data-item":`item-${i}`},[e("input",{type:"checkbox",class:"shopping-checkbox",checked:s.value.has(`item-${i}`),onChange:m=>c(`item-${i}`)},null,40,xs),e("span",ws,y(o),1)],10,Ts))),128))])])):I("",!0),e("div",As,[e("button",{class:"action-btn primary",onClick:l},n[6]||(n[6]=[e("i",{class:"fas fa-download"},null,-1),b(" Descargar Lista ",-1)])),e("button",{class:"action-btn secondary",onClick:n[0]||(n[0]=o=>t.$emit("clear"))},n[7]||(n[7]=[e("i",{class:"fas fa-trash"},null,-1),b(" Limpiar Lista ",-1)])),e("button",{class:"action-btn success",onClick:v},n[8]||(n[8]=[e("i",{class:"fas fa-check-double"},null,-1),b(" Marcar Todo ",-1)]))])])]))}},Bs=S(js,[["__scopeId","data-v-3804f03e"]]);function Os(){const r=B(),a=w(),s=A(),c=O();return{generateShoppingList:async p=>{if(s.selectedRecipesForShopping.length===0)throw new Error("Por favor selecciona al menos una receta para generar la lista de compras");a.setLoading(!0);try{const l=s.savedRecipes.filter(d=>s.selectedRecipesForShopping.includes(d.id));let t=[];l.forEach(d=>{d.data.ingredientes&&(t=t.concat(d.data.ingredientes))});const n=`
        Eres un asistente experto en compras de supermercado. Necesito que generes una lista de compras inteligente basada en los siguientes ingredientes de recetas:

        INGREDIENTES DE LAS RECETAS:
        ${t.map((d,k)=>`${k+1}. ${d}`).join(`
`)}

        ${p.excludeInventory?`
MIS INGREDIENTES ACTUALES (excluir estos ingredientes):
${c.ingredients.map(d=>`- ${d}`).join(`
`)}`:""}

        INSTRUCCIONES:
        1. Analiza todos los ingredientes y crea una lista de compras optimizada
        2. Combina ingredientes similares (ej: si aparece "tomate - 2 unidades" y "tomate - 1 unidad", combinar como "tomate - 3 unidades")
        3. ${p.excludeInventory?"Excluye los ingredientes que ya tengo disponibles":"Incluye todos los ingredientes"}
        4. ${p.includeBasics?"Incluye ingredientes básicos comunes (sal, pimienta, aceite) si no están listados":"No agregues ingredientes básicos adicionales"}
        5. ${p.groupByCategory?"Agrupa los ingredientes por categorías de supermercado":"Lista todos los ingredientes juntos"}
        6. Optimiza las cantidades para evitar desperdicios
        7. Sugiere alternativas o marcas cuando sea apropiado

        IMPORTANTE: Responde ÚNICAMENTE con un JSON válido, sin texto adicional. Usa esta estructura:
        ${p.groupByCategory?`{
          "resumen": {
              "totalItems": 0,
              "categorias": 0,
              "recetasIncluidas": ${l.length}
          },
          "categorias": {
              "carnes_pescados": {
                  "nombre": "Carnes y Pescados",
                  "icono": "fas fa-drumstick-bite",
                  "items": ["item - cantidad"]
              },
              "vegetales_frutas": {
                  "nombre": "Vegetales y Frutas",
                  "icono": "fas fa-apple-alt",
                  "items": ["item - cantidad"]
              },
              "lacteos_huevos": {
                  "nombre": "Lácteos y Huevos",
                  "icono": "fas fa-cheese",
                  "items": ["item - cantidad"]
              },
              "cereales_granos": {
                  "nombre": "Cereales y Granos",
                  "icono": "fas fa-seedling",
                  "items": ["item - cantidad"]
              },
              "condimentos_especias": {
                  "nombre": "Condimentos y Especias",
                  "icono": "fas fa-pepper-hot",
                  "items": ["item - cantidad"]
              },
              "otros": {
                  "nombre": "Otros",
                  "icono": "fas fa-shopping-basket",
                  "items": ["item - cantidad"]
              }
          }
      }`:`{
          "resumen": {
              "totalItems": 0,
              "recetasIncluidas": ${l.length}
          },
          "items": ["item - cantidad", "item - cantidad"]
      }`}
      `;let i=(await r.callGeminiAPI(n)).trim();return i.startsWith("```json")&&(i=i.replace(/```json\n?/,"").replace(/\n?```$/,"")),i.startsWith("```")&&(i=i.replace(/```\n?/,"").replace(/\n?```$/,"")),JSON.parse(i)}catch(l){throw console.error("Error al generar la lista de compras:",l),l}finally{a.setLoading(!1)}}}}const zs={class:"shopping-list"},Ds={class:"shopping-controls"},Ns=["disabled"],qs={__name:"ShoppingList",setup(r){const a=A(),s=w(),c=Os(),v=C({includeBasics:!0,groupByCategory:!0,excludeInventory:!0}),p=C(null),l=j(()=>a.selectedRecipesForShopping.length>0),t=async()=>{try{const o=await c.generateShoppingList(v.value);p.value=o}catch(o){alert(o.message)}},n=()=>{confirm("¿Estás seguro de que quieres limpiar la lista de compras?")&&(p.value=null,a.selectedRecipesForShopping.length=0)};return(o,i)=>(u(),g("div",zs,[i[4]||(i[4]=e("header",{class:"section-header"},[e("h2",null,[e("i",{class:"fas fa-shopping-cart"}),b(" Lista de Compras Inteligente")]),e("p",null," Genera automáticamente tu lista de compras basada en las recetas y tus ingredientes actuales ")],-1)),e("div",Ds,[R(Qe),R(ds,{"include-basics":v.value.includeBasics,"onUpdate:includeBasics":i[0]||(i[0]=m=>v.value.includeBasics=m),"group-by-category":v.value.groupByCategory,"onUpdate:groupByCategory":i[1]||(i[1]=m=>v.value.groupByCategory=m),"exclude-inventory":v.value.excludeInventory,"onUpdate:excludeInventory":i[2]||(i[2]=m=>v.value.excludeInventory=m)},null,8,["include-basics","group-by-category","exclude-inventory"]),e("button",{class:"generate-btn",disabled:!l.value||h(s).isLoading,"aria-label":"Generar lista de compras",onClick:t},[i[3]||(i[3]=e("i",{class:"fas fa-list-alt"},null,-1)),b(" "+y(h(s).isLoading?"Generando...":"Generar Lista de Compras"),1)],8,Ns)]),p.value?(u(),M(Bs,{key:0,"shopping-list":p.value,"group-by-category":v.value.groupByCategory,onClear:n},null,8,["shopping-list","group-by-category"])):I("",!0)]))}},Ps=S(qs,[["__scopeId","data-v-e0b299ff"]]),Gs={class:"main-app"},Ms={class:"tab-content",role:"tabpanel","aria-labelledby":"recipe-creator-tab"},Vs={class:"tab-content",role:"tabpanel","aria-labelledby":"shopping-list-tab"},Us={__name:"HomeView",setup(r){const a=w();return(s,c)=>(u(),g("main",Gs,[R(te),z(e("section",Ms,[R(ze)],512),[[N,h(a).currentTab==="recipe-creator"]]),z(e("section",Vs,[R(Ps)],512),[[N,h(a).currentTab==="shopping-list"]])]))}},Ks=S(Us,[["__scopeId","data-v-7898df1b"]]);export{Ks as default};
//# sourceMappingURL=HomeView-BhSzy4-W.js.map
