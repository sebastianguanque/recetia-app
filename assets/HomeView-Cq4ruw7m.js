import{_ as R,u as B,a as z,c as g,b as e,d as $,n as E,e as b,o as u,f as G,r as y,g as V,h as C,t as h,w as N,v as H,i as U,F as A,j as w,k as L,l as O,m as T,p as F,q as J,s as W,x as X,y as Q,z as Y,T as Z,A as P}from"./index-CEHdgGb0.js";const ee={class:"tabs",role:"tablist"},se={class:"tabs-list"},ae={class:"tab"},te=["aria-selected"],ne={class:"tab"},oe=["aria-selected"],ie={__name:"AppTabs",setup(c){const a=B(),s=z(),l=()=>{const v=prompt("Ingresa nueva API Key de Gemini:",s.apiKey);v&&v.trim()&&(s.setApiKey(v.trim()),alert("API Key actualizada correctamente"))};return(v,r)=>(u(),g("nav",ee,[e("ul",se,[e("li",ae,[e("button",{id:"recipe-creator-tab",class:E(["tab-button",{active:$(a).currentTab==="recipe-creator"}]),role:"tab","aria-selected":$(a).currentTab==="recipe-creator","aria-controls":"recipe-creator",onClick:r[0]||(r[0]=p=>$(a).switchTab("recipe-creator"))},r[2]||(r[2]=[e("i",{class:"fas fa-magic"},null,-1),b(" Creador de Recetas ",-1)]),10,te)]),e("li",ne,[e("button",{id:"shopping-list-tab",class:E(["tab-button",{active:$(a).currentTab==="shopping-list"}]),role:"tab","aria-selected":$(a).currentTab==="shopping-list","aria-controls":"shopping-list",onClick:r[1]||(r[1]=p=>$(a).switchTab("shopping-list"))},r[3]||(r[3]=[e("i",{class:"fas fa-shopping-cart"},null,-1),b(" Lista de Compras ",-1)]),10,oe)]),e("li",{class:"tab"},[e("button",{class:"tab-button",role:"button","aria-label":"Configuración de la aplicación",onClick:l},r[4]||(r[4]=[e("i",{class:"fas fa-cog"},null,-1),b(" Configuración ",-1)]))])])]))}},re=R(ie,[["__scopeId","data-v-1e74daa8"]]),D=G("ingredients",()=>{const{getItem:c,setItem:a}=V(),s=y(c("inventory_items",[]));return{ingredients:s,addIngredient:t=>{const o=t.toLowerCase().trim();o&&!s.value.includes(o)&&(s.value.push(o),a("inventory_items",s.value))},removeIngredient:t=>{s.value.splice(t,1),a("inventory_items",s.value)},clearAllIngredients:()=>{s.value=[],a("inventory_items",s.value)},categorizeIngredients:()=>{const t={meats:["pollo","carne","pescado","cerdo","ternera","atun","salmón"],vegetables:["verduras","brócoli","zanahoria","espinaca","tomate","cebolla","pimiento","lechuga","calabacín"],carbs:["arroz","pasta","pan","patata","patatas","quinoa","batata","harina","tortillas"],dairy:["leche","queso","yogurt","manteca","crema"],eggs:["huevos","huevo"],fruits:["manzana","plátano","naranja","frutas","fresa","uvas","kiwi","arándanos"],cereals:["avena","cereales","granola"],legumes:["lentejas","garbanzos","frijoles","judías"],fats:["aceite","aguacate","nueces","almendras","aceitunas"]},o={meats:[],vegetables:[],carbs:[],dairy:[],eggs:[],fruits:[],cereals:[],legumes:[],fats:[],others:[]};return s.value.forEach(i=>{let d=!1;for(const[f,n]of Object.entries(t))if(n.includes(i.toLowerCase())){o[f].push(i),d=!0;break}d||o.others.push(i)}),o}}}),le={class:"inventory-section"},ce={class:"section-header"},de={class:"input-group"},ue={class:"inventory-list",role:"list"},pe={key:0,class:"empty-state"},ge={class:"ingredient-name"},me=["aria-label","onClick"],ve={__name:"IngredientsList",setup(c){const a=D(),s=y(""),l=y(""),v=y(null),r=y(null),p=()=>{if(!s.value.trim()){l.value="Debes ingresar un ingrediente antes de agregar.",L(()=>{v.value&&v.value.focus()});return}l.value="",a.addIngredient(s.value.trim()),s.value=""},t=y(""),o=y(null),i=y(null),d=()=>{if(a.ingredients.length===0){t.value="No hay ingredientes para eliminar.",L(()=>{o.value&&o.value.focus()});return}t.value="",confirm("¿Estás seguro de que quieres eliminar todos los ingredientes?")&&a.clearAllIngredients()};return(f,n)=>(u(),g("section",le,[e("header",ce,[n[2]||(n[2]=e("h3",null,"Mis Ingredientes:",-1)),e("button",{class:"clear-btn",title:"Limpiar todos los ingredientes","aria-label":"Limpiar todos los ingredientes",onClick:d,ref_key:"clearBtn",ref:i},n[1]||(n[1]=[e("i",{class:"fas fa-trash-alt"},null,-1),b(" Limpiar Todo ",-1)]),512),t.value?(u(),g("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"clearErrorRef",ref:o},h(t.value),513)):C("",!0)]),e("form",{class:"input-form",onSubmit:U(p,["prevent"])},[e("div",de,[n[4]||(n[4]=e("label",{for:"inventoryItem",class:"sr-only"}," Agregar ingrediente ",-1)),N(e("input",{id:"inventoryItem","onUpdate:modelValue":n[0]||(n[0]=m=>s.value=m),type:"text",placeholder:"Ej: tomates, cebolla, pollo, arroz...","aria-label":"Ingresa un ingrediente"},null,512),[[H,s.value]]),e("button",{type:"submit","aria-label":"Agregar ingrediente",ref_key:"addBtn",ref:r},n[3]||(n[3]=[e("i",{class:"fas fa-plus"},null,-1),b(" Agregar ",-1)]),512),l.value?(u(),g("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:v},h(l.value),513)):C("",!0)])],32),e("ul",ue,[$(a).ingredients.length===0?(u(),g("li",pe,n[5]||(n[5]=[e("p",null," No hay ingredientes agregados. Agrega algunos ingredientes que tienes disponibles. ",-1)]))):C("",!0),(u(!0),g(A,null,w($(a).ingredients,(m,I)=>(u(),g("li",{key:`${m}-${I}`,class:"inventory-item",role:"listitem"},[e("span",ge,h(m),1),e("button",{class:"remove-item","aria-label":`Eliminar ${m}`,title:"Eliminar ingrediente",onClick:x=>$(a).removeIngredient(I)},n[6]||(n[6]=[e("i",{class:"fas fa-times"},null,-1)]),8,me)]))),128))])]))}},fe=R(ve,[["__scopeId","data-v-f3968b48"]]),be={class:"meal-type-section"},he={class:"meal-buttons",role:"group","aria-label":"Tipo de comida"},ye=["data-meal","aria-checked","onClick"],$e={__name:"MealTypeSelector",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(c,{emit:a}){const s=a,l=[{value:"desayuno",label:"Desayuno",icon:"fas fa-sun"},{value:"almuerzo",label:"Almuerzo",icon:"fas fa-utensils"},{value:"merienda",label:"Merienda",icon:"fas fa-cookie"},{value:"cena",label:"Cena",icon:"fas fa-moon"}],v=r=>{s("update:modelValue",r)};return(r,p)=>(u(),g("section",be,[p[0]||(p[0]=e("h3",null,"Tipo de comida:",-1)),e("div",he,[(u(),g(A,null,w(l,t=>e("button",{key:t.value,class:E(["meal-btn",{selected:c.modelValue===t.value}]),"data-meal":t.value,role:"radio","aria-checked":c.modelValue===t.value,onClick:o=>v(t.value)},[e("i",{class:E(t.icon)},null,2),b(" "+h(t.label),1)],10,ye)),64))])]))}},ke=R($e,[["__scopeId","data-v-f2090326"]]),_e={class:"recipe-card"},Ce={class:"recipe-header"},Se={key:0},Ie={class:"recipe-info"},Le={class:"info-item"},Re={class:"info-item"},Ee={class:"info-item"},Te={class:"ingredients-section"},xe={class:"ingredients-list"},Ae={class:"instructions-section"},we={class:"instructions-list"},Be={key:0,class:"tips-section"},Me={class:"tips-content"},je={__name:"RecipeCard",props:{recipe:{type:Object,required:!0},mealType:{type:String,required:!0}},setup(c){const a=c,s={desayuno:"fas fa-sun",almuerzo:"fas fa-utensils",merienda:"fas fa-cookie",cena:"fas fa-moon"},l={desayuno:"Desayuno",almuerzo:"Almuerzo",merienda:"Merienda",cena:"Cena"},v=O(()=>s[a.mealType]||"fas fa-utensils"),r=O(()=>l[a.mealType]||a.mealType);return(p,t)=>(u(),g("article",_e,[e("header",Ce,[e("h3",null,[e("i",{class:E(v.value)},null,2),b(" "+h(c.recipe.nombre),1)]),e("p",null,[t[0]||(t[0]=e("strong",null,"Tipo:",-1)),b(" "+h(r.value),1)]),c.recipe.cookingMethod?(u(),g("p",Se,[t[1]||(t[1]=e("strong",null,"Método de cocción:",-1)),b(" "+h(c.recipe.cookingMethod),1)])):C("",!0)]),e("div",Ie,[e("div",Le,[t[2]||(t[2]=e("i",{class:"fas fa-clock"},null,-1)),t[3]||(t[3]=e("strong",null,"Tiempo",-1)),e("span",null,h(c.recipe.tiempo),1)]),e("div",Re,[t[4]||(t[4]=e("i",{class:"fas fa-users"},null,-1)),t[5]||(t[5]=e("strong",null,"Porciones",-1)),e("span",null,h(c.recipe.porciones),1)]),e("div",Ee,[t[6]||(t[6]=e("i",{class:"fas fa-chart-line"},null,-1)),t[7]||(t[7]=e("strong",null,"Complejidad",-1)),e("span",null,h(c.recipe.complejidad),1)])]),e("section",Te,[t[8]||(t[8]=e("h4",null,[e("i",{class:"fas fa-list"}),b(" Ingredientes:")],-1)),e("div",xe,[e("ul",null,[(u(!0),g(A,null,w(c.recipe.ingredientes,o=>(u(),g("li",{key:o},h(o),1))),128))])])]),e("section",Ae,[t[9]||(t[9]=e("h4",null,[e("i",{class:"fas fa-tasks"}),b(" Instrucciones:")],-1)),e("div",we,[e("ol",null,[(u(!0),g(A,null,w(c.recipe.instrucciones,o=>(u(),g("li",{key:o},h(o),1))),128))])])]),c.recipe.consejos?(u(),g("section",Be,[t[10]||(t[10]=e("h4",null,[e("i",{class:"fas fa-lightbulb"}),b(" Consejos:")],-1)),e("div",Me,[e("p",null,h(c.recipe.consejos),1)])])):C("",!0)]))}},K=R(je,[["__scopeId","data-v-1a3d8684"]]),M=G("recipes",()=>{const{getItem:c,setItem:a}=V(),s=y(c("saved_recipes",[])),l=y([]);return{savedRecipes:s,selectedRecipesForShopping:l,saveRecipe:(o,i="individual")=>{const d={id:Date.now(),type:i,data:o,createdAt:new Date().toISOString()};s.value.push(d),a("saved_recipes",s.value)},deleteRecipe:o=>{s.value=s.value.filter(i=>i.id!==o),l.value=l.value.filter(i=>i!==o),a("saved_recipes",s.value)},clearAllRecipes:()=>{s.value=[],l.value=[],a("saved_recipes",s.value)},toggleRecipeSelection:o=>{const i=l.value.indexOf(o);i>-1?l.value.splice(i,1):l.value.push(o)}}});function Ne(){const c=z(),a=B();M();const s=D(),l=y(""),v=y(""),r=y(null);return{selectedMealType:l,selectedCookingMethod:v,generatedRecipe:r,generateRecipe:async()=>{if(s.ingredients.length===0)throw new Error("Por favor, agrega ingredientes a tu inventario para generar una receta.");if(!l.value)throw new Error("Por favor, selecciona un tipo de comida antes de generar la receta.");if(!v.value)throw new Error("Selecciona el método de cocción antes de generar la receta.");a.setLoading(!0);try{const t=s.categorizeIngredients(),o=s.ingredients.join(", ");let i="";switch(l.value){case"desayuno":i="Para el desayuno, genera una receta típica y adecuada para la primera comida del día. Evita explícitamente el uso de carnes pesadas (como pollo, carne de res) o pescados como ingrediente principal, y preparaciones muy elaboradas o que requieran mucho tiempo. Prioriza opciones como cereales, huevos, frutas, o lácteos.";break;case"merienda":i="Para la merienda, debe ser una opción ligera, rápida y energizante para media tarde. Evita platos principales o que requieran cocción compleja.";break;case"almuerzo":i="Para el almuerzo, genera una comida principal y sustanciosa. Debe ser una receta completa que pueda incluir proteínas, carbohidratos y vegetales.";break;case"cena":i="Para la cena, genera una comida balanceada, nutritiva y adecuada para la última comida del día. Puede ser ligeramente más ligera que el almuerzo.";break}const d=`El método de cocción seleccionado por el usuario es: ${v.value}. Adapta la receta y las instrucciones para que sean adecuadas para este método.`,f=`
        Eres un chef experto y nutricionista con un profundo conocimiento de dietas balanceadas y costumbres culinarias de Argentina. Tu objetivo es combinar la tradición culinaria local con principios nutricionales modernos para crear recetas y consejos que sean saludables, deliciosos y culturalmente apropiados.
        Necesito que generes una única receta para la comida de ${l.value}.

        Los ingredientes que tengo disponibles en mi inventario son: ${o}.
        ${i}
        ${d}

        Para la receta, proporciona:
        - **Nombre del plato**
        - **Lista completa de ingredientes** con cantidades aproximadas (puedes agregar ingredientes básicos como sal, pimienta, aceite, especias, si son necesarios y no están explícitamente en la lista original).
        - **Instrucciones** paso a paso, claras y concisas.
        - **Tiempo** de preparación (ej. "20 minutos").
        - **Porciones** (ej. "1 persona", "2 personas", "6 personas", etc).
        - **Nivel de complejidad** (Fácil/Intermedio/Difícil).
        - **Consejos** adicionales (opcional, uno o varios si aplica).

        Asegúrate de que la receta sea coherente, balanceada, nutritiva y que use los ingredientes de mi inventario de manera inteligente, no es necesario usar todos los ingredientes.
        Si un ingrediente es esencial para el tipo de comida y no está en el inventario, puedes incluirlo pero prioriza el uso de lo que tengo.

        IMPORTANTE: Responde ÚNICAMENTE con un JSON válido, sin texto adicional antes o después. No incluyas explicaciones o texto introductorio/final. Usa esta estructura exacta:
        {
            "nombre": "Nombre del plato",
            "ingredientes": ["ingrediente 1 - cantidad", "ingrediente 2 - cantidad"],
            "instrucciones": ["paso 1", "paso 2"],
            "tiempo": "X minutos",
            "porciones": "X personas",
            "complejidad": "Fácil",
            "consejos": "Consejos adicionales (opcional)"
        }
      `;let m=(await c.callGeminiAPI(f)).trim();m.startsWith("```json")&&(m=m.replace(/```json\n?/,"").replace(/\n?```$/,"")),m.startsWith("```")&&(m=m.replace(/```\n?/,"").replace(/\n?```$/,""));const I=JSON.parse(m);return I.id=Date.now().toString(),I.mealType=l.value,I.cookingMethod=v.value,r.value=I,I}catch(t){throw console.error("Error al generar la receta:",t),t}finally{a.setLoading(!1)}}}}const Oe={class:"recipe-creator"},ze={class:"cooking-method-section"},De=["disabled"],qe={__name:"RecipeCreator",setup(c){const a=Ne(),s=D(),l=B(),v=z();O(()=>s.ingredients.length>0&&a.selectedMealType.value&&v.hasApiKey);const r=y(""),p=y(null),t=y(null),o=async()=>{if(!l.isLoading){if(!v.hasApiKey){r.value="Debes ingresar una API Key válida antes de generar una receta.",L(()=>{p.value&&p.value.focus()});return}if(s.ingredients.length===0){r.value="Agrega al menos un ingrediente antes de generar una receta.",L(()=>{p.value&&p.value.focus()});return}if(!a.selectedMealType.value){r.value="Selecciona un tipo de comida antes de generar la receta.",L(()=>{p.value&&p.value.focus()});return}if(!a.selectedCookingMethod.value){r.value="Selecciona el método de cocción antes de generar la receta.",L(()=>{p.value&&p.value.focus()});return}r.value="";try{await a.generateRecipe()}catch(f){r.value=f.message,L(()=>{p.value&&p.value.focus()})}}},i=M(),d=()=>{const f=a.generatedRecipe.value;f&&(i.saveRecipe(f),alert("Receta guardada correctamente."))};return(f,n)=>(u(),g("div",Oe,[n[6]||(n[6]=e("header",{class:"section-header"},[e("h2",null,[e("i",{class:"fas fa-magic"}),b(" Creador de Recetas Inteligente")]),e("p",null,"Administra tus ingredientes y genera recetas personalizadas con IA")],-1)),T(fe),T(ke,{modelValue:$(a).selectedMealType.value,"onUpdate:modelValue":n[0]||(n[0]=m=>$(a).selectedMealType.value=m),class:"meal-type-section"},null,8,["modelValue"]),e("div",ze,[n[3]||(n[3]=e("label",{for:"cookingMethod",class:"cooking-label"},"Método de cocción:",-1)),N(e("select",{id:"cookingMethod","onUpdate:modelValue":n[1]||(n[1]=m=>$(a).selectedCookingMethod.value=m),"aria-label":"Selecciona el método de cocción",class:"cooking-select"},n[2]||(n[2]=[W('<option value="" data-v-7c37bfc3>Selecciona...</option><option value="Freidora de Aire" data-v-7c37bfc3>Freidora de Aire</option><option value="Horno" data-v-7c37bfc3>Horno</option><option value="Microondas" data-v-7c37bfc3>Microondas</option><option value="Parrilla" data-v-7c37bfc3>Parrilla</option><option value="Olla" data-v-7c37bfc3>Olla</option><option value="Sartén" data-v-7c37bfc3>Sartén</option><option value="Vapor" data-v-7c37bfc3>Vapor</option>',8)]),512),[[J,$(a).selectedCookingMethod.value]])]),e("button",{class:"generate-btn","aria-label":"Generar receta",onClick:o,disabled:$(l).isLoading,ref_key:"generateBtn",ref:t},[n[4]||(n[4]=e("i",{class:"fas fa-magic"},null,-1)),b(" "+h($(l).isLoading?"Generando...":"Generar Receta"),1)],8,De),r.value?(u(),g("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:p},h(r.value),513)):C("",!0),$(a).generatedRecipe.value?(u(),F(K,{key:1,recipe:$(a).generatedRecipe.value,"meal-type":$(a).selectedMealType.value,class:"recipe-result"},null,8,["recipe","meal-type"])):C("",!0),$(a).generatedRecipe.value?(u(),g("button",{key:2,class:"save-btn",onClick:d,style:{"margin-top":"16px"}},n[5]||(n[5]=[e("i",{class:"fas fa-save"},null,-1),b(" Guardar Receta ",-1)]))):C("",!0)]))}},Pe=R(qe,[["__scopeId","data-v-7c37bfc3"]]),Ge={class:"recipe-selection"},Ve={class:"section-header"},Ue={class:"saved-recipes-list"},Fe={key:0,class:"no-recipes"},Ke=["data-recipe-id"],He={class:"recipe-info-compact"},Je={class:"recipe-name"},We={class:"recipe-meta"},Xe={class:"recipe-actions"},Qe=["aria-label","onClick"],Ye=["aria-label","onClick"],Ze=["aria-label","onClick"],es={__name:"SavedRecipesList",setup(c){const a=M(),s=_=>a.selectedRecipesForShopping.includes(_),l=_=>new Date(_).toLocaleDateString("es-ES"),v=_=>{const k=a.savedRecipes.find(S=>S.id===_);confirm(`¿Estás seguro de que quieres eliminar la receta "${k?.data.nombre}"?`)&&a.deleteRecipe(_)},r=y(""),p=y(null),t=()=>{if(a.savedRecipes.length===0){r.value="No hay recetas guardadas para eliminar.",L(()=>{p.value&&p.value.focus()});return}r.value="",confirm("¿Estás seguro de que quieres eliminar todas las recetas guardadas?")&&a.clearAllRecipes()},o=y(!1),i=y(null),d=y(null),f=y(null),n=_=>{i.value=_,o.value=!0},m=()=>{o.value=!1,i.value=null},I=()=>{if(!i.value)return;const _=i.value.data.ingredientes?.map(k=>k.nombre?`${k.cantidad||""} ${k.unidad||""} ${k.nombre}`.trim():k).join(`
`)||"";navigator.clipboard.writeText(_),alert("Ingredientes copiados al portapapeles.")},x=()=>{if(!i.value)return;const _=i.value.data.instrucciones?.join(`
`)||"";navigator.clipboard.writeText(_),alert("Instrucciones copiadas al portapapeles.")},j=_=>{o.value&&_.key==="Escape"&&m()};return X(()=>(window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j))),Q(o,_=>{_&&f.value&&f.value.focus()}),(_,k)=>(u(),g("section",Ge,[e("header",Ve,[k[1]||(k[1]=e("h3",null,"Recetas Guardadas:",-1)),e("button",{class:"clear-btn",title:"Eliminar todas las recetas guardadas","aria-label":"Eliminar todas las recetas guardadas",onClick:t,ref:"clearBtn"},k[0]||(k[0]=[e("i",{class:"fas fa-trash-alt"},null,-1),b(" Eliminar Todas ",-1)]),512),r.value?(u(),g("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:p},h(r.value),513)):C("",!0)]),e("ul",Ue,[$(a).savedRecipes.length===0?(u(),g("li",Fe,k[2]||(k[2]=[e("i",{class:"fas fa-book-dead no-recipes-icon"},null,-1),e("p",null,[b("No hay recetas guardadas."),e("br"),b("Genera algunas recetas primero.")],-1)]))):C("",!0),(u(!0),g(A,null,w($(a).savedRecipes,S=>(u(),g("li",{key:S.id,class:E(["recipe-item",{selected:s(S.id)}]),"data-recipe-id":S.id},[e("div",He,[e("div",Je,h(S.data.nombre),1),e("div",We,[k[3]||(k[3]=e("i",{class:"fas fa-calendar"},null,-1)),b(" "+h(l(S.createdAt))+" • "+h(S.data.tiempo)+" • "+h(S.data.porciones),1)])]),e("div",Xe,[e("button",{class:"recipe-select-btn","aria-label":s(S.id)?"Deseleccionar receta":"Seleccionar receta",onClick:q=>$(a).toggleRecipeSelection(S.id)},h(s(S.id)?"Deseleccionar":"Seleccionar"),9,Qe),e("button",{class:"recipe-delete-btn",title:"Eliminar receta","aria-label":`Eliminar receta ${S.data.nombre}`,onClick:q=>v(S.id)},k[4]||(k[4]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ye),e("button",{class:"recipe-view-btn",title:"Ver receta","aria-label":`Ver receta ${S.data.nombre}`,onClick:q=>n(S)},k[5]||(k[5]=[e("i",{class:"fas fa-eye"},null,-1),b(" Ver ",-1)]),8,Ze)])],10,Ke))),128))]),T(Z,{name:"modal-fade"},{default:Y(()=>[o.value?(u(),g("div",{key:0,class:"modal-overlay blur-bg",onClick:U(m,["self"]),tabindex:"-1"},[e("div",{class:"modal-content",ref_key:"modalContent",ref:d},[e("button",{class:"close-modal-btn",onClick:m,ref_key:"closeBtn",ref:f}," Cerrar ",512),T(K,{recipe:i.value.data,"meal-type":i.value.data.mealType},null,8,["recipe","meal-type"]),e("div",{class:"copy-actions"},[e("button",{class:"copy-btn",onClick:I},k[6]||(k[6]=[e("i",{class:"fas fa-copy"},null,-1),b(" Copiar ingredientes ",-1)])),e("button",{class:"copy-btn",onClick:x},k[7]||(k[7]=[e("i",{class:"fas fa-copy"},null,-1),b(" Copiar instrucciones ",-1)]))])],512)])):C("",!0)]),_:1})]))}},ss=R(es,[["__scopeId","data-v-7f230431"]]),as={class:"shopping-options"},ts={role:"group","aria-labelledby":"shopping-options-heading"},ns={class:"option-group"},os={class:"checkbox-label"},is=["checked"],rs={class:"option-group"},ls={class:"checkbox-label"},cs=["checked"],ds={class:"option-group"},us={class:"checkbox-label"},ps=["checked"],gs={__name:"ShoppingOptions",props:{includeBasics:{type:Boolean,default:!0},groupByCategory:{type:Boolean,default:!0},excludeInventory:{type:Boolean,default:!0}},emits:["update:includeBasics","update:groupByCategory","update:excludeInventory"],setup(c){return(a,s)=>(u(),g("section",as,[s[9]||(s[9]=e("h3",null,"Opciones de Lista:",-1)),e("div",ts,[e("div",ns,[e("label",os,[e("input",{type:"checkbox",checked:c.includeBasics,onChange:s[0]||(s[0]=l=>a.$emit("update:includeBasics",l.target.checked))},null,40,is),s[3]||(s[3]=e("span",{class:"checkmark"},null,-1)),s[4]||(s[4]=b(" Incluir ingredientes básicos (sal, aceite, especias) ",-1))])]),e("div",rs,[e("label",ls,[e("input",{type:"checkbox",checked:c.groupByCategory,onChange:s[1]||(s[1]=l=>a.$emit("update:groupByCategory",l.target.checked))},null,40,cs),s[5]||(s[5]=e("span",{class:"checkmark"},null,-1)),s[6]||(s[6]=b(" Agrupar por categorías (carnes, vegetales, etc.) ",-1))])]),e("div",ds,[e("label",us,[e("input",{type:"checkbox",checked:c.excludeInventory,onChange:s[2]||(s[2]=l=>a.$emit("update:excludeInventory",l.target.checked))},null,40,ps),s[7]||(s[7]=e("span",{class:"checkmark"},null,-1)),s[8]||(s[8]=b(" Excluir ingredientes que ya tengo ",-1))])])])]))}},ms=R(gs,[["__scopeId","data-v-8343a330"]]),vs={class:"shopping-list-result"},fs={class:"shopping-summary"},bs={class:"summary-stats"},hs={class:"stat-item"},ys={class:"stat-number"},$s={key:0,class:"stat-item"},ks={class:"stat-number"},_s={class:"stat-item"},Cs={class:"stat-number"},Ss={class:"shopping-list-card"},Is={key:0},Ls={key:0},Rs={key:1,class:"shopping-items"},Es=["data-item"],Ts=["checked","onChange"],xs={class:"shopping-item-text"},As={key:1,class:"shopping-category"},ws={class:"shopping-items"},Bs=["data-item"],Ms=["checked","onChange"],js={class:"shopping-item-text"},Ns={class:"shopping-actions"},Os={__name:"ShoppingListResult",props:{shoppingList:{type:Object,required:!0},groupByCategory:{type:Boolean,default:!0}},emits:["clear"],setup(c){const a=c,s=y(new Set),l=t=>{s.value.has(t)?s.value.delete(t):s.value.add(t)},v=()=>{r().forEach(o=>s.value.add(o))},r=()=>{const t=[];return a.groupByCategory&&a.shoppingList.categorias?Object.entries(a.shoppingList.categorias).forEach(([o,i])=>{i.items&&i.items.forEach((d,f)=>{t.push(`${o}-${f}`)})}):a.shoppingList.items&&a.shoppingList.items.forEach((o,i)=>{t.push(`item-${i}`)}),t},p=()=>{let t=`=== LISTA DE COMPRAS ===

`;t+=`Generada el: ${new Date().toLocaleDateString()}
`,t+=`Total de productos: ${a.shoppingList.resumen.totalItems}
`,t+=`Productos completados: ${s.value.size}

`,t+=`PRODUCTOS PENDIENTES:
`,a.groupByCategory&&a.shoppingList.categorias?Object.entries(a.shoppingList.categorias).forEach(([f,n])=>{n.items&&n.items.length>0&&(t+=`
${n.nombre.toUpperCase()}:
`,n.items.forEach((m,I)=>{const x=`${f}-${I}`;s.value.has(x)||(t+=`☐ ${m}
`)}))}):a.shoppingList.items&&a.shoppingList.items.forEach((f,n)=>{const m=`item-${n}`;s.value.has(m)||(t+=`☐ ${f}
`)}),s.value.size>0&&(t+=`
PRODUCTOS COMPLETADOS:
`,a.groupByCategory&&a.shoppingList.categorias?Object.entries(a.shoppingList.categorias).forEach(([f,n])=>{n.items&&n.items.length>0&&n.items.filter((I,x)=>s.value.has(`${f}-${x}`)).length>0&&(t+=`
${n.nombre.toUpperCase()}:
`,n.items.forEach((I,x)=>{const j=`${f}-${x}`;s.value.has(j)&&(t+=`☑ ${I}
`)}))}):a.shoppingList.items&&a.shoppingList.items.forEach((f,n)=>{const m=`item-${n}`;s.value.has(m)&&(t+=`☑ ${f}
`)}));const o=new Blob([t],{type:"text/plain"}),i=URL.createObjectURL(o),d=document.createElement("a");d.href=i,d.download=`lista-compras-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(i),alert("Lista de compras exportada exitosamente")};return(t,o)=>(u(),g("div",vs,[e("div",fs,[o[4]||(o[4]=e("h3",null,[e("i",{class:"fas fa-chart-pie"}),b(" Resumen de tu Lista de Compras")],-1)),e("div",bs,[e("div",hs,[e("span",ys,h(c.shoppingList.resumen.totalItems),1),o[1]||(o[1]=e("div",{class:"stat-label"},"Productos totales",-1))]),c.groupByCategory?(u(),g("div",$s,[e("span",ks,h(c.shoppingList.resumen.categorias),1),o[2]||(o[2]=e("div",{class:"stat-label"},"Categorías",-1))])):C("",!0),e("div",_s,[e("span",Cs,h(c.shoppingList.resumen.recetasIncluidas),1),o[3]||(o[3]=e("div",{class:"stat-label"},"Recetas incluidas",-1))])])]),e("div",Ss,[e("h3",null,[o[5]||(o[5]=e("i",{class:"fas fa-list-alt"},null,-1)),b(" Lista de Compras"+h(c.groupByCategory?" por Categorías":""),1)]),c.groupByCategory&&c.shoppingList.categorias?(u(),g("div",Is,[(u(!0),g(A,null,w(Object.entries(c.shoppingList.categorias),([i,d])=>(u(),g("div",{key:i,class:"shopping-category"},[d.items&&d.items.length>0?(u(),g("h4",Ls,[e("i",{class:E(d.icono)},null,2),b(" "+h(d.nombre),1)])):C("",!0),d.items&&d.items.length>0?(u(),g("div",Rs,[(u(!0),g(A,null,w(d.items,(f,n)=>(u(),g("div",{key:`${i}-${n}`,class:E(["shopping-item",{checked:s.value.has(`${i}-${n}`)}]),"data-item":`${i}-${n}`},[e("input",{type:"checkbox",class:"shopping-checkbox",checked:s.value.has(`${i}-${n}`),onChange:m=>l(`${i}-${n}`)},null,40,Ts),e("span",xs,h(f),1)],10,Es))),128))])):C("",!0)]))),128))])):c.shoppingList.items?(u(),g("div",As,[e("div",ws,[(u(!0),g(A,null,w(c.shoppingList.items,(i,d)=>(u(),g("div",{key:`item-${d}`,class:E(["shopping-item",{checked:s.value.has(`item-${d}`)}]),"data-item":`item-${d}`},[e("input",{type:"checkbox",class:"shopping-checkbox",checked:s.value.has(`item-${d}`),onChange:f=>l(`item-${d}`)},null,40,Ms),e("span",js,h(i),1)],10,Bs))),128))])])):C("",!0),e("div",Ns,[e("button",{class:"action-btn primary",onClick:p},o[6]||(o[6]=[e("i",{class:"fas fa-download"},null,-1),b(" Descargar Lista ",-1)])),e("button",{class:"action-btn secondary",onClick:o[0]||(o[0]=i=>t.$emit("clear"))},o[7]||(o[7]=[e("i",{class:"fas fa-trash"},null,-1),b(" Limpiar Lista ",-1)])),e("button",{class:"action-btn success",onClick:v},o[8]||(o[8]=[e("i",{class:"fas fa-check-double"},null,-1),b(" Marcar Todo ",-1)]))])])]))}},zs=R(Os,[["__scopeId","data-v-3804f03e"]]);function Ds(){const c=z(),a=B(),s=M(),l=D();return{generateShoppingList:async r=>{if(s.selectedRecipesForShopping.length===0)throw new Error("Por favor selecciona al menos una receta para generar la lista de compras");a.setLoading(!0);try{const p=s.savedRecipes.filter(n=>s.selectedRecipesForShopping.includes(n.id));let t=[];p.forEach(n=>{n.data.ingredientes&&(t=t.concat(n.data.ingredientes))});const o=`
        Eres un asistente experto en compras de supermercado. Necesito que generes una lista de compras inteligente basada en los siguientes ingredientes de recetas:

        INGREDIENTES DE LAS RECETAS:
        ${t.map((n,m)=>`${m+1}. ${n}`).join(`
`)}

        ${r.excludeInventory?`
MIS INGREDIENTES ACTUALES (excluir estos ingredientes):
${l.ingredients.map(n=>`- ${n}`).join(`
`)}`:""}

        INSTRUCCIONES:
        1. Analiza todos los ingredientes y crea una lista de compras optimizada
        2. Combina ingredientes similares (ej: si aparece "tomate - 2 unidades" y "tomate - 1 unidad", combinar como "tomate - 3 unidades")
        3. ${r.excludeInventory?"Excluye los ingredientes que ya tengo disponibles":"Incluye todos los ingredientes"}
        4. ${r.includeBasics?"Incluye ingredientes básicos comunes (sal, pimienta, aceite) si no están listados":"No agregues ingredientes básicos adicionales"}
        5. ${r.groupByCategory?"Agrupa los ingredientes por categorías de supermercado":"Lista todos los ingredientes juntos"}
        6. Optimiza las cantidades para evitar desperdicios
        7. Sugiere alternativas o marcas cuando sea apropiado

        IMPORTANTE: Responde ÚNICAMENTE con un JSON válido, sin texto adicional. Usa esta estructura:
        ${r.groupByCategory?`{
          "resumen": {
              "totalItems": 0,
              "categorias": 0,
              "recetasIncluidas": ${p.length}
          },
          "categorias": {
              "carnes_pescados": {
                  "nombre": "Carnes y Pescados",
                  "icono": "fas fa-drumstick-bite",
                  "items": ["item - cantidad"]
              },
              "vegetales_frutas": {
                  "nombre": "Vegetales y Frutas",
                  "icono": "fas fa-apple-alt",
                  "items": ["item - cantidad"]
              },
              "lacteos_huevos": {
                  "nombre": "Lácteos y Huevos",
                  "icono": "fas fa-cheese",
                  "items": ["item - cantidad"]
              },
              "cereales_granos": {
                  "nombre": "Cereales y Granos",
                  "icono": "fas fa-seedling",
                  "items": ["item - cantidad"]
              },
              "condimentos_especias": {
                  "nombre": "Condimentos y Especias",
                  "icono": "fas fa-pepper-hot",
                  "items": ["item - cantidad"]
              },
              "otros": {
                  "nombre": "Otros",
                  "icono": "fas fa-shopping-basket",
                  "items": ["item - cantidad"]
              }
          }
      }`:`{
          "resumen": {
              "totalItems": 0,
              "recetasIncluidas": ${p.length}
          },
          "items": ["item - cantidad", "item - cantidad"]
      }`}
      `;let d=(await c.callGeminiAPI(o)).trim();return d.startsWith("```json")&&(d=d.replace(/```json\n?/,"").replace(/\n?```$/,"")),d.startsWith("```")&&(d=d.replace(/```\n?/,"").replace(/\n?```$/,"")),JSON.parse(d)}catch(p){throw console.error("Error al generar la lista de compras:",p),p}finally{a.setLoading(!1)}}}}const qs={class:"shopping-list"},Ps={class:"shopping-controls"},Gs=["disabled"],Vs={__name:"ShoppingList",setup(c){const a=M(),s=B(),l=Ds(),v=y({includeBasics:!0,groupByCategory:!0,excludeInventory:!0}),r=y(null);O(()=>a.selectedRecipesForShopping.length>0);const p=y(""),t=y(null),o=y(null),i=async()=>{if(!s.isLoading){if(a.selectedRecipesForShopping.length===0){p.value="Selecciona al menos una receta antes de generar la lista de compras.",L(()=>{t.value&&t.value.focus()});return}p.value="";try{const f=await l.generateShoppingList(v.value);r.value=f}catch(f){p.value=f.message,L(()=>{t.value&&t.value.focus()})}}},d=()=>{confirm("¿Estás seguro de que quieres limpiar la lista de compras?")&&(r.value=null,a.selectedRecipesForShopping.length=0)};return(f,n)=>(u(),g("div",qs,[n[4]||(n[4]=e("header",{class:"section-header"},[e("h2",null,[e("i",{class:"fas fa-shopping-cart"}),b(" Lista de Compras Inteligente")]),e("p",null," Genera automáticamente tu lista de compras basada en las recetas y tus ingredientes actuales ")],-1)),e("div",Ps,[T(ss),T(ms,{"include-basics":v.value.includeBasics,"onUpdate:includeBasics":n[0]||(n[0]=m=>v.value.includeBasics=m),"group-by-category":v.value.groupByCategory,"onUpdate:groupByCategory":n[1]||(n[1]=m=>v.value.groupByCategory=m),"exclude-inventory":v.value.excludeInventory,"onUpdate:excludeInventory":n[2]||(n[2]=m=>v.value.excludeInventory=m)},null,8,["include-basics","group-by-category","exclude-inventory"]),e("button",{class:"generate-btn","aria-label":"Generar lista de compras",onClick:i,disabled:$(s).isLoading,ref_key:"generateBtn",ref:o},[n[3]||(n[3]=e("i",{class:"fas fa-list-alt"},null,-1)),b(" "+h($(s).isLoading?"Generando...":"Generar Lista de Compras"),1)],8,Gs),p.value?(u(),g("div",{key:0,class:"error-message","aria-live":"assertive",tabindex:"-1",ref_key:"errorRef",ref:t},h(p.value),513)):C("",!0)]),r.value?(u(),F(zs,{key:0,"shopping-list":r.value,"group-by-category":v.value.groupByCategory,onClear:d},null,8,["shopping-list","group-by-category"])):C("",!0)]))}},Us=R(Vs,[["__scopeId","data-v-4bfc12b0"]]),Fs={class:"main-app"},Ks={class:"tab-content",role:"tabpanel","aria-labelledby":"recipe-creator-tab"},Hs={class:"tab-content",role:"tabpanel","aria-labelledby":"shopping-list-tab"},Js={__name:"HomeView",setup(c){const a=B();return(s,l)=>(u(),g("main",Fs,[T(re),N(e("section",Ks,[T(Pe)],512),[[P,$(a).currentTab==="recipe-creator"]]),N(e("section",Hs,[T(Us)],512),[[P,$(a).currentTab==="shopping-list"]])]))}},Xs=R(Js,[["__scopeId","data-v-7898df1b"]]);export{Xs as default};
//# sourceMappingURL=HomeView-Cq4ruw7m.js.map
